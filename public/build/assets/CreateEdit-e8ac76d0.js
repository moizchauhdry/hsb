import{J as G,q as p,v as H,B as A,c as _,u as t,e as Z,w as q,h as m,b as s,g as J,n as B,j as d,E as u,F as b,r as g,a as n,s as y,t as i,f as N,G as v,o as a}from"./app-72da05a5.js";import{_ as c}from"./InputError-f5260652.js";import{Z as D}from"./vue-datepicker-63be2623.js";/* empty css             */import{_ as Q}from"./SuccessButton-e969be21.js";const W={class:"col"},X=s("i",{class:"bx bx-plus text-lg"},null,-1),Y={key:1,class:"modal fade show",id:"exampleLargeModal",tabindex:"-1","aria-hidden":"true",style:{display:"block"}},ee={class:"modal-dialog modal-lg"},se={class:"modal-content"},te=s("h5",{class:"modal-title"},"Policies",-1),oe={class:"modal-body"},le={id:"stepper1",class:"bs-stepper"},ne={class:"card"},ie={class:"card-header"},re={class:"d-lg-flex flex-lg-row align-items-lg-center justify-content-lg-between",role:"tablist"},ce={class:"step"},ae={class:"step-trigger",role:"tab"},_e=s("div",{class:""},[s("h5",{class:"mb-0 steper-title"},"Policy Info "),s("p",{class:"mb-0 steper-sub-title"},"Enter Policy Details")],-1),de=s("div",{class:"bs-stepper-line"},null,-1),ue={class:"step"},pe={class:"step-trigger",role:"tab"},me=s("div",{class:""},[s("h5",{class:"mb-0 steper-title"},"Policy Amount"),s("p",{class:"mb-0 steper-sub-title"},"Setup Policy Amount")],-1),ye=s("div",{class:"bs-stepper-line"},null,-1),be={class:"step"},ge={class:"step-trigger",role:"tab"},he=s("div",{class:""},[s("h5",{class:"mb-0 steper-title"},"Confirmation"),s("p",{class:"mb-0 steper-sub-title"},"Policy Confirmation")],-1),ve={class:"card-body"},fe={key:0,class:"row g-2"},xe={class:"col-md-4"},ke=s("label",{for:"input13",class:"form-label"},"Client",-1),Ve=["value"],Pe={class:"col-md-4"},Ce=s("label",{for:"input21",class:"form-label"},"Insurer",-1),Se=["value"],we={class:"col-md-4"},Ue=s("label",{for:"input21",class:"form-label"},"Insurance type",-1),Be=s("option",{value:"takaful"},"Takaful",-1),Ne=s("option",{value:"conventional"},"Conventional",-1),De=[Be,Ne],Ie={class:"col-md-4"},Ee=s("label",{for:"input21",class:"form-label"},"Lead type",-1),Le=s("option",{value:"1"},"Direct 100%",-1),Ae=s("option",{value:"2"},"Our lead",-1),$e=s("option",{value:"3"},"Other lead",-1),Re=[Le,Ae,$e],Te={class:"col-md-4"},Fe=s("label",{for:"input13",class:"form-label"},"Co insurance",-1),Ke=["disabled"],Me={class:"col-md-4"},Oe=s("label",{for:"input13",class:"form-label"},"Policy No",-1),je={class:"col-md-4"},ze=s("label",{for:"input13",class:"form-label"},"Cover note no",-1),Ge={class:"col-md-4"},He=s("label",{for:"input21",class:"form-label"},"Agency",-1),Ze=["value"],qe={class:"col-md-4"},Je=s("label",{for:"departmentSelect",class:"form-label"},"Department",-1),Qe=["value"],We={class:"col-md-4"},Xe=s("label",{for:"businessClassSelect",class:"form-label"},"Business Class",-1),Ye=["value"],es={class:"col-md-4"},ss=s("label",{for:"input21",class:"form-label"},"Policy Type",-1),ts=s("option",{value:"new"},"New",-1),os=s("option",{value:"renewal"},"Renewal",-1),ls=s("option",{value:"endorsement"},"Endorsement",-1),ns=s("option",{value:"other"},"Other",-1),is=[ts,os,ls,ns],rs={class:"col-md-4"},cs=s("label",{for:"",class:"form-label"},"Date of Issuance",-1),as={class:"col-md-4"},_s=s("label",{for:"input13",class:"form-label"},"Inception Date",-1),ds={class:"col-md-4"},us=s("label",{for:"input13",class:"form-label"},"Expiry Date",-1),ps={class:"col-md-4"},ms=s("label",{for:"input13",class:"form-label"},"Installment plan",-1),ys=s("option",{value:"2"},"2",-1),bs=s("option",{value:"3"},"3",-1),gs=s("option",{value:"4"},"4",-1),hs=[ys,bs,gs],vs={key:1,class:"row g-2"},fs={class:"border mb-4",id:"partner"},xs={class:"table-responsive"},ks={class:"table",style:{"margin-top":"10px","margin-bottom":"10px"}},Vs={style:{"text-align":"center"}},Ps=s("th",null,"Sum insured",-1),Cs={style:{"text-align":"center"}},Ss=s("th",null,"Gross premium",-1),ws={style:{"text-align":"center"}},Us=s("th",null,"Net premium",-1),Bs={style:{"text-align":"center"}},Ns=s("th",null,"Percentage",-1),Ds={style:{"text-align":"center"}},Is=s("th",null,"HSB Profit",-1),Es={class:"table-responsive"},Ls={class:"table table-bordered text-capitalize"},As=s("tr",null,[s("th",{colspan:"4",class:"bg-primary text-white"}," Policy Detail ")],-1),$s=s("th",null,"Client",-1),Rs=s("th",null,"Insurance",-1),Ts=s("th",null,"Insurance type",-1),Fs=s("th",null,"Lead type",-1),Ks=s("th",null,"Co Insurance",-1),Ms=s("th",null,"Policy No.",-1),Os=s("th",null,"Agency",-1),js=s("th",null,"Department",-1),zs=s("th",null,"Class of Business",-1),Gs=s("th",null,"Policy Type",-1),Hs=s("th",null," Cover Note No ",-1),Zs=s("th",null,"Installment Plan ",-1),qs={class:"table-responsive"},Js={class:"table table-bordered text-capitalize"},Qs=s("tr",null,[s("th",{colspan:"4",class:"bg-primary text-white"}," Policy Amount ")],-1),Ws=s("th",null,"Sum insured ",-1),Xs=s("th",null,"Gross Premium ",-1),Ys=s("th",null,"Net Premium ",-1),et=s("th",null,"Percentage",-1),st=s("th",null,"HSB profit",-1),tt={class:"card-footer"},ot={class:"col-12"},lt={class:"d-flex align-items-center gap-3"},nt=s("i",{class:"bx bx-left-arrow-alt me-2"},null,-1),it=s("i",{class:"bx bx-right-arrow-alt ms-2"},null,-1),rt={key:2,class:"btn btn-success px-4"},mt={__name:"CreateEdit",props:{policy:Object},setup(ct,{expose:$}){const R=G().props.can,h=p(!1),f=p(!1),I=p([]),x=p([]),k=p([]),V=p([]),P=p([]),C=p([]),e=H({current_step:1,total_step:3,policy_id:"",client_id:"",insurer_id:"",co_insurance:"",insurance_type:"",lead_type:"",department_id:"",policy_no:"",agency_id:"",agency_code:"",cob_id:"",policy_type:"",date_of_issuance:"",policy_period_start:"",policy_period_end:"",sum_insured:"",gross_premium:"",net_premium:"",cover_note_no:"",installment_plan:"",leader:"",leader_policy_no:"",branch:"",brokerage_amount:"",tax:"",percentage:"",brokerage_amount:""}),T=()=>{h.value=!0,f.value=!1,v.get("/policy/create").then(({data:r})=>{I.value=r.users,x.value=r.clients,k.value=r.insurances,V.value=r.agencies,C.value=r.departments})},F=()=>{v.get(`/policy/getDepartmentByBusinessClass/${e.department_id}`).then(({data:r})=>{P.value=r.cobs}).catch(r=>{console.error("Error fetching business classes:",r)})},E=()=>{f.value?e.post(route("policy.update"),{preserveScroll:!0,onSuccess:()=>{e.current_step++,e.current_step>3&&S()},onError:()=>L(),onFinish:()=>{}}):e.post(route("policy.store"),{preserveScroll:!0,onSuccess:()=>{e.current_step++,e.current_step>3&&S()},onError:()=>L(),onFinish:()=>{}})},L=()=>{},K=()=>{e.current_step>1&&e.current_step--},M=()=>{e.current_step<e.total_step&&E()},S=()=>{h.value=!1,e.current_step=1,e.errors={},e.policy_id="",e.client_id="",e.insurer_id="",e.co_insurance="",e.insurance_type="",e.policy_no="",e.agency_id="",e.agency_code="",e.cob_id="",e.policy_type="",e.date_of_issuance="",e.policy_period_start="",e.policy_period_end="",e.sum_insured="",e.gross_premium="",e.net_premium="",e.cover_note_no="",e.installment_plan="",e.leader="",e.leader_policy_no="",e.branch="",e.brokerage_amount="",e.user_id="",e.tax="",e.rate_percentage=""},O=r=>{h.value=!0,f.value=!0,v.get(`/policy/edit/${r}`).then(({data:o})=>{I.value=o.users,x.value=o.clients,k.value=o.insurances,V.value=o.agencies,P.value=o.cobs,C.value=o.departments,e.policy_id=o.policy.id,e.client_id=o.policy.client_id,e.insurer_id=o.policy.insurer_id,e.co_insurance=o.policy.co_insurance,e.insurance_type=o.policy.insurance_type,e.department_id=o.policy.department_id,e.lead_type=o.policy.lead_type,e.policy_no=o.policy.policy_no,e.agency_id=o.policy.agency_id,e.agency_code=o.policy.agency_code,e.cob_id=o.policy.cob_id,e.policy_type=o.policy.policy_type,e.date_of_issuance=o.policy.date_of_issuance,e.policy_period_start=o.policy.policy_period_start,e.policy_period_end=o.policy.policy_period_end,e.sum_insured=o.policy.sum_insured,e.gross_premium=o.policy.gross_premium,e.net_premium=o.policy.net_premium,e.cover_note_no=o.policy.cover_note_no,e.installment_plan=o.policy.installment_plan,e.leader=o.policy.leader,e.leader_policy_no=o.policy.leader_policy_no,e.branch=o.policy.branch,e.brokerage_amount=o.policy.brokerage_amount,e.tax=o.policy.tax,e.rate_percentage=o.policy.percentage,e.brokerage_amount=o.policy.brokerage_amount})};$({edit:r=>O(r)});const j=()=>e.department_id===1?e.net_premium!==0?e.sum_insured/e.net_premium:null:e.department_id!==null&&e.gross_premium!==0?e.sum_insured/e.gross_premium:null;A(()=>j(),r=>{e.rate_percentage=r});let w=null;const z=()=>{v.get(`/policy/getBusinessClassByPercent/${e.cob_id}`).then(({data:r})=>{w=r.cobPercentage,e.gross_premium&&U()}).catch(r=>{console.error("Error fetching percentage:",r)})},U=()=>{w&&e.gross_premium&&(e.brokerage_amount=e.gross_premium*w/100)};return A(()=>e.gross_premium,U),(r,o)=>(a(),_("div",W,[t(R).policy_create?(a(),Z(Q,{key:0,onClick:T,class:"mr-1"},{default:q(()=>[X,N(" Add Policy")]),_:1})):m("",!0),h.value?(a(),_("div",Y,[s("div",ee,[s("div",se,[s("form",{onSubmit:o[20]||(o[20]=J(l=>E(),["prevent"]))},[s("div",{class:"modal-header"},[te,s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:S})]),s("div",oe,[s("div",le,[s("div",ne,[s("div",ie,[s("div",re,[s("div",ce,[s("div",ae,[s("div",{class:B(["bs-stepper-circle",{"bs-stepper-circle-active":t(e).current_step==1}])}," 1 ",2),_e])]),de,s("div",ue,[s("div",pe,[s("div",{class:B(["bs-stepper-circle",{"bs-stepper-circle-active":t(e).current_step==2}])}," 2 ",2),me])]),ye,s("div",be,[s("div",ge,[s("div",{class:B(["bs-stepper-circle",{"bs-stepper-circle-active":t(e).current_step==3}])}," 3 ",2),he])])])]),s("div",ve,[t(e).current_step==1?(a(),_("div",fe,[s("div",xe,[ke,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[0]||(o[0]=l=>t(e).client_id=l)},[(a(!0),_(b,null,g(x.value,l=>(a(),_("option",{key:l.id,value:l.id},i(l.name),9,Ve))),128))],512),[[u,t(e).client_id]]),n(c,{message:t(e).errors.client_id},null,8,["message"])]),s("div",Pe,[Ce,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[1]||(o[1]=l=>t(e).insurer_id=l)},[(a(!0),_(b,null,g(k.value,l=>(a(),_("option",{key:l.id,value:l.id},i(l.name),9,Se))),128))],512),[[u,t(e).insurer_id]]),n(c,{message:t(e).errors.insurer_id},null,8,["message"])]),s("div",we,[Ue,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[2]||(o[2]=l=>t(e).insurance_type=l)},De,512),[[u,t(e).insurance_type]]),n(c,{message:t(e).errors.insurance_type},null,8,["message"])]),s("div",Ie,[Ee,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[3]||(o[3]=l=>t(e).lead_type=l)},Re,512),[[u,t(e).lead_type]]),n(c,{message:t(e).errors.lead_type},null,8,["message"])]),s("div",Te,[Fe,d(s("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":o[4]||(o[4]=l=>t(e).co_insurance=l),disabled:t(e).lead_type==="2"},null,8,Ke),[[y,t(e).co_insurance]]),n(c,{message:t(e).errors.co_insurance},null,8,["message"])]),s("div",Me,[Oe,d(s("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":o[5]||(o[5]=l=>t(e).policy_no=l)},null,512),[[y,t(e).policy_no]]),n(c,{message:t(e).errors.policy_no},null,8,["message"])]),s("div",je,[ze,d(s("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":o[6]||(o[6]=l=>t(e).cover_note_no=l)},null,512),[[y,t(e).cover_note_no]]),n(c,{message:t(e).errors.cover_note_no},null,8,["message"])]),s("div",Ge,[He,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[7]||(o[7]=l=>t(e).agency_id=l)},[(a(!0),_(b,null,g(V.value,l=>(a(),_("option",{key:l.id,value:l.id},i(l.name),9,Ze))),128))],512),[[u,t(e).agency_id]]),n(c,{message:t(e).errors.agency_id},null,8,["message"])]),s("div",qe,[Je,d(s("select",{id:"departmentSelect",class:"form-select","onUpdate:modelValue":o[8]||(o[8]=l=>t(e).department_id=l),onChange:F},[(a(!0),_(b,null,g(C.value,l=>(a(),_("option",{value:l.id},i(l.name),9,Qe))),256))],544),[[u,t(e).department_id]]),n(c,{message:t(e).errors.department_id},null,8,["message"])]),s("div",We,[Xe,d(s("select",{id:"businessClassSelect",class:"form-select","onUpdate:modelValue":o[9]||(o[9]=l=>t(e).cob_id=l),onChange:z},[(a(!0),_(b,null,g(P.value,l=>(a(),_("option",{value:l.id},i(l.class_name),9,Ye))),256))],544),[[u,t(e).cob_id]]),n(c,{message:t(e).errors.cob_id},null,8,["message"])]),s("div",es,[ss,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[10]||(o[10]=l=>t(e).policy_type=l)},is,512),[[u,t(e).policy_type]]),n(c,{message:t(e).errors.policy_type},null,8,["message"])]),s("div",rs,[cs,n(t(D),{modelValue:t(e).date_of_issuance,"onUpdate:modelValue":o[11]||(o[11]=l=>t(e).date_of_issuance=l),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(e).errors.date_of_issuance},null,8,["message"])]),s("div",as,[_s,n(t(D),{modelValue:t(e).policy_period_start,"onUpdate:modelValue":o[12]||(o[12]=l=>t(e).policy_period_start=l),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(e).errors.policy_period_start},null,8,["message"])]),s("div",ds,[us,n(t(D),{modelValue:t(e).policy_period_end,"onUpdate:modelValue":o[13]||(o[13]=l=>t(e).policy_period_end=l),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(e).errors.policy_period_end},null,8,["message"])]),s("div",ps,[ms,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[14]||(o[14]=l=>t(e).installment_plan=l)},hs,512),[[u,t(e).installment_plan]]),n(c,{message:t(e).errors.installment_plan},null,8,["message"])])])):m("",!0),t(e).current_step==2?(a(),_("div",vs,[s("div",fs,[s("div",xs,[s("table",ks,[s("tr",Vs,[Ps,s("td",null,[d(s("input",{type:"number",class:"form-control",id:"sum_insured","onUpdate:modelValue":o[15]||(o[15]=l=>t(e).sum_insured=l)},null,512),[[y,t(e).sum_insured]]),n(c,{message:t(e).errors.sum_insured},null,8,["message"])])]),s("tr",Cs,[Ss,s("td",null,[d(s("input",{type:"number",class:"form-control",id:"gross_premium","onUpdate:modelValue":o[16]||(o[16]=l=>t(e).gross_premium=l),onInput:U},null,544),[[y,t(e).gross_premium]]),n(c,{message:t(e).errors.gross_premium},null,8,["message"])])]),s("tr",ws,[Us,s("td",null,[d(s("input",{type:"number",class:"form-control",id:"net_premium","onUpdate:modelValue":o[17]||(o[17]=l=>t(e).net_premium=l)},null,512),[[y,t(e).net_premium]]),n(c,{message:t(e).errors.net_premium},null,8,["message"])])]),s("tr",Bs,[Ns,s("td",null,[d(s("input",{type:"number",class:"form-control",id:"percentage","onUpdate:modelValue":o[18]||(o[18]=l=>t(e).rate_percentage=l),readonly:""},null,512),[[y,t(e).rate_percentage]]),n(c,{message:t(e).errors.rate_percentage},null,8,["message"])])]),s("tr",Ds,[Is,s("td",null,[d(s("input",{type:"number",class:"form-control",id:"brokerage_amount","onUpdate:modelValue":o[19]||(o[19]=l=>t(e).brokerage_amount=l)},null,512),[[y,t(e).brokerage_amount]]),n(c,{message:t(e).errors.brokerage_amount},null,8,["message"])])])])])])])):m("",!0),t(e).current_step==3?(a(),_(b,{key:2},[s("div",Es,[s("table",Ls,[As,s("tr",null,[$s,s("td",null,i(t(e).client_id),1),Rs,s("td",null,i(t(e).insurer_id),1)]),s("tr",null,[Ts,s("td",null,i(t(e).insurance_type),1),Fs,s("td",null,i(t(e).lead_type),1)]),s("tr",null,[Ks,s("td",null,i(t(e).co_insurance),1),Ms,s("td",null,i(t(e).policy_no),1)]),s("tr",null,[Os,s("td",null,i(t(e).agency_id),1),js,s("td",null,i(t(e).department_id),1)]),s("tr",null,[zs,s("td",null,i(t(e).cob_id),1),Gs,s("td",null,i(t(e).policy_type),1)]),s("tr",null,[Hs,s("td",null,i(t(e).cover_note_no),1),Zs,s("td",null,i(t(e).installment_plan),1)])])]),s("div",qs,[s("table",Js,[Qs,s("tr",null,[Ws,s("td",null," PKR "+i(t(e).sum_insured.toLocaleString()),1),Xs,s("td",null," PKR "+i(t(e).gross_premium.toLocaleString()),1)]),s("tr",null,[Ys,s("td",null," PKR "+i(t(e).net_premium.toLocaleString()),1),et,s("td",null,i(t(e).rate_percentage)+" % ",1)]),s("tr",null,[st,s("td",null," PKR "+i(t(e).brokerage_amount.toLocaleString()),1)])])])],64)):m("",!0)]),s("div",tt,[s("div",ot,[s("div",lt,[[2,3].includes(t(e).current_step)?(a(),_("button",{key:0,class:"btn btn-outline-secondary px-4",type:"button",onClick:K},[nt,N("Previous")])):m("",!0),[1,2].includes(t(e).current_step)?(a(),_("button",{key:1,class:"btn btn-primary px-4",type:"button",onClick:M},[N("Next"),it])):m("",!0),t(e).current_step==3?(a(),_("button",rt,"Save & Submit")):m("",!0)])])])])])])],32)])])])):m("",!0)]))}};export{mt as default};
