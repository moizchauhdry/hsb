import{J as X,q as p,v as q,A,c as _,u as t,e as J,w as Q,h as m,b as s,g as W,n as B,j as d,y as u,F as b,r as g,a as n,z as y,t as i,f as N,x as v,o as a}from"./app-4f0bfa58.js";import{_ as c}from"./InputError-13f879d8.js";import{X as D}from"./vue-datepicker-2a1c26cd.js";/* empty css             */import{_ as Y}from"./PrimaryButton-b4e55c93.js";const Z={class:"col"},ee=s("i",{class:"bx bx-plus text-lg"},null,-1),se={key:1,class:"modal fade show",id:"exampleLargeModal",tabindex:"-1","aria-hidden":"true",style:{display:"block"}},te={class:"modal-dialog modal-lg"},oe={class:"modal-content"},le=s("h5",{class:"modal-title"},"Policies",-1),ne={class:"modal-body"},ie={id:"stepper1",class:"bs-stepper"},re={class:"card"},ce={class:"card-header"},ae={class:"d-lg-flex flex-lg-row align-items-lg-center justify-content-lg-between",role:"tablist"},_e={class:"step"},de={class:"step-trigger",role:"tab"},ue=s("div",{class:""},[s("h5",{class:"mb-0 steper-title"},"Policy Info "),s("p",{class:"mb-0 steper-sub-title"},"Enter Policy Details")],-1),pe=s("div",{class:"bs-stepper-line"},null,-1),me={class:"step"},ye={class:"step-trigger",role:"tab"},be=s("div",{class:""},[s("h5",{class:"mb-0 steper-title"},"Policy Amount"),s("p",{class:"mb-0 steper-sub-title"},"Setup Policy Amount")],-1),ge=s("div",{class:"bs-stepper-line"},null,-1),he={class:"step"},ve={class:"step-trigger",role:"tab"},fe=s("div",{class:""},[s("h5",{class:"mb-0 steper-title"},"Confirmation"),s("p",{class:"mb-0 steper-sub-title"},"Policy Confirmation")],-1),xe={class:"card-body"},ke={key:0,class:"row g-2"},Ve={class:"col-md-4"},Pe=s("label",{for:"input13",class:"form-label"},"Client",-1),Ce=["value"],Se={class:"col-md-4"},we=s("label",{for:"input21",class:"form-label"},"Insurer",-1),Ue=["value"],Be={class:"col-md-4"},Ne=s("label",{for:"input21",class:"form-label"},"Insurance type",-1),De=s("option",{value:"takaful"},"Takaful",-1),Ie=s("option",{value:"conventional"},"Conventional",-1),Ee=[De,Ie],Le={class:"col-md-4"},Ae=s("label",{for:"input21",class:"form-label"},"Lead type",-1),$e=s("option",{value:"1"},"Direct 100%",-1),Re=s("option",{value:"2"},"Our lead",-1),Te=s("option",{value:"3"},"Other lead",-1),ze=[$e,Re,Te],Fe={class:"col-md-4"},Ke=s("label",{for:"input13",class:"form-label"},"Co insurance",-1),Me=["disabled"],Oe={class:"col-md-4"},je=s("label",{for:"input13",class:"form-label"},"Policy No",-1),Ge={class:"col-md-4"},He=s("label",{for:"input13",class:"form-label"},"Cover note no",-1),Xe={class:"col-md-4"},qe=s("label",{for:"input21",class:"form-label"},"Agency",-1),Je=["value"],Qe={class:"col-md-4"},We=s("label",{for:"departmentSelect",class:"form-label"},"Department",-1),Ye=["value"],Ze={class:"col-md-4"},es=s("label",{for:"businessClassSelect",class:"form-label"},"Business Class",-1),ss=["value"],ts={class:"col-md-4"},os=s("label",{for:"input21",class:"form-label"},"Policy Type",-1),ls=s("option",{value:"new"},"New",-1),ns=s("option",{value:"renewal"},"Renewal",-1),is=s("option",{value:"endorsement"},"Endorsement",-1),rs=s("option",{value:"other"},"Other",-1),cs=[ls,ns,is,rs],as={class:"col-md-4"},_s=s("label",{for:"",class:"form-label"},"Date of Issuance",-1),ds={class:"col-md-4"},us=s("label",{for:"input13",class:"form-label"},"Inception Date",-1),ps={class:"col-md-4"},ms=s("label",{for:"input13",class:"form-label"},"Expiry Date",-1),ys={class:"col-md-4"},bs=s("label",{for:"input13",class:"form-label"},"Installment plan",-1),gs=s("option",{value:"2"},"2",-1),hs=s("option",{value:"3"},"3",-1),vs=s("option",{value:"4"},"4",-1),fs=[gs,hs,vs],xs={key:1,class:"row g-2"},ks={class:"border mb-4",id:"partner"},Vs={class:"table-responsive"},Ps={class:"table",style:{"margin-top":"10px","margin-bottom":"10px"}},Cs={style:{"text-align":"center"}},Ss=s("th",null,"Sum insured",-1),ws={style:{"text-align":"center"}},Us=s("th",null,"Gross premium",-1),Bs={style:{"text-align":"center"}},Ns=s("th",null,"Net premium",-1),Ds={style:{"text-align":"center"}},Is=s("th",null,"Percentage",-1),Es={style:{"text-align":"center"}},Ls=s("th",null,"HSB Profit",-1),As={class:"table-responsive"},$s={class:"table table-bordered text-capitalize"},Rs=s("tr",null,[s("th",{colspan:"4",class:"bg-primary text-white"}," Policy Detail ")],-1),Ts=s("th",null,"Client",-1),zs=s("th",null,"Insurance",-1),Fs=s("th",null,"Insurance type",-1),Ks=s("th",null,"Lead type",-1),Ms=s("th",null,"Co Insurance",-1),Os=s("th",null,"Policy No.",-1),js=s("th",null,"Agency",-1),Gs=s("th",null,"Department",-1),Hs=s("th",null,"Class of Business",-1),Xs=s("th",null,"Policy Type",-1),qs=s("th",null," Cover Note No ",-1),Js=s("th",null,"Installment Plan ",-1),Qs={class:"table-responsive"},Ws={class:"table table-bordered text-capitalize"},Ys=s("tr",null,[s("th",{colspan:"4",class:"bg-primary text-white"}," Policy Amount ")],-1),Zs=s("th",null,"Sum insured ",-1),et=s("th",null,"Gross Premium ",-1),st=s("th",null,"Net Premium ",-1),tt=s("th",null,"Percentage",-1),ot=s("th",null,"HSB profit",-1),lt={class:"card-footer"},nt={class:"col-12"},it={class:"d-flex align-items-center gap-3"},rt=s("i",{class:"bx bx-left-arrow-alt me-2"},null,-1),ct=s("i",{class:"bx bx-right-arrow-alt ms-2"},null,-1),at={key:2,class:"btn btn-success px-4"},yt={__name:"CreateEdit",props:{policy:Object,create:Boolean},setup($,{expose:R}){const T=$,z=X().props.can,h=p(!1),f=p(!1),I=p([]),x=p([]),k=p([]),V=p([]),P=p([]),C=p([]),e=q({current_step:1,total_step:3,policy_id:"",client_id:"",insurer_id:"",co_insurance:"",insurance_type:"",lead_type:"",department_id:"",policy_no:"",agency_id:"",agency_code:"",cob_id:"",policy_type:"",date_of_issuance:"",policy_period_start:"",policy_period_end:"",sum_insured:"",gross_premium:"",net_premium:"",cover_note_no:"",installment_plan:"",leader:"",leader_policy_no:"",branch:"",brokerage_amount:"",tax:"",percentage:"",brokerage_amount:""}),F=()=>{h.value=!0,f.value=!1,v.get("/policy/create").then(({data:r})=>{I.value=r.users,x.value=r.clients,k.value=r.insurances,V.value=r.agencies,C.value=r.departments})},K=()=>{v.get(`/policy/getDepartmentByBusinessClass/${e.department_id}`).then(({data:r})=>{P.value=r.cobs}).catch(r=>{console.error("Error fetching business classes:",r)})},E=()=>{f.value?e.post(route("policy.update"),{preserveScroll:!0,onSuccess:()=>{e.current_step++,e.current_step>3&&S()},onError:()=>L(),onFinish:()=>{}}):e.post(route("policy.store"),{preserveScroll:!0,onSuccess:()=>{e.current_step++,e.current_step>3&&S()},onError:()=>L(),onFinish:()=>{}})},L=()=>{},M=()=>{e.current_step>1&&e.current_step--},O=()=>{e.current_step<e.total_step&&E()},S=()=>{h.value=!1,e.current_step=1,e.errors={},e.policy_id="",e.client_id="",e.insurer_id="",e.co_insurance="",e.insurance_type="",e.policy_no="",e.agency_id="",e.agency_code="",e.cob_id="",e.policy_type="",e.date_of_issuance="",e.policy_period_start="",e.policy_period_end="",e.sum_insured="",e.gross_premium="",e.net_premium="",e.cover_note_no="",e.installment_plan="",e.leader="",e.leader_policy_no="",e.branch="",e.brokerage_amount="",e.user_id="",e.tax="",e.rate_percentage=""},j=r=>{h.value=!0,f.value=!0,v.get(`/policy/edit/${r}`).then(({data:o})=>{I.value=o.users,x.value=o.clients,k.value=o.insurances,V.value=o.agencies,P.value=o.cobs,C.value=o.departments,e.policy_id=o.policy.id,e.client_id=o.policy.client_id,e.insurer_id=o.policy.insurer_id,e.co_insurance=o.policy.co_insurance,e.insurance_type=o.policy.insurance_type,e.department_id=o.policy.department_id,e.lead_type=o.policy.lead_type,e.policy_no=o.policy.policy_no,e.agency_id=o.policy.agency_id,e.agency_code=o.policy.agency_code,e.cob_id=o.policy.cob_id,e.policy_type=o.policy.policy_type,e.date_of_issuance=o.policy.date_of_issuance,e.policy_period_start=o.policy.policy_period_start,e.policy_period_end=o.policy.policy_period_end,e.sum_insured=o.policy.sum_insured,e.gross_premium=o.policy.gross_premium,e.net_premium=o.policy.net_premium,e.cover_note_no=o.policy.cover_note_no,e.installment_plan=o.policy.installment_plan,e.leader=o.policy.leader,e.leader_policy_no=o.policy.leader_policy_no,e.branch=o.policy.branch,e.brokerage_amount=o.policy.brokerage_amount,e.tax=o.policy.tax,e.rate_percentage=o.policy.percentage,e.brokerage_amount=o.policy.brokerage_amount})};R({edit:r=>j(r)});const G=()=>e.department_id===1?e.net_premium!==0?e.sum_insured/e.net_premium:null:e.department_id!==null&&e.gross_premium!==0?e.sum_insured/e.gross_premium:null;A(()=>G(),r=>{e.rate_percentage=r});let w=null;const H=()=>{v.get(`/policy/getBusinessClassByPercent/${e.cob_id}`).then(({data:r})=>{w=r.cobPercentage,e.gross_premium&&U()}).catch(r=>{console.error("Error fetching percentage:",r)})},U=()=>{w&&e.gross_premium&&(e.brokerage_amount=e.gross_premium*w/100)};return A(()=>e.gross_premium,U),(r,o)=>(a(),_("div",Z,[t(z).policy_create&&T.create?(a(),J(Y,{key:0,onClick:F,class:"mr-1"},{default:Q(()=>[ee,N(" Add Policy ")]),_:1})):m("",!0),h.value?(a(),_("div",se,[s("div",te,[s("div",oe,[s("form",{onSubmit:o[20]||(o[20]=W(l=>E(),["prevent"]))},[s("div",{class:"modal-header"},[le,s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:S})]),s("div",ne,[s("div",ie,[s("div",re,[s("div",ce,[s("div",ae,[s("div",_e,[s("div",de,[s("div",{class:B(["bs-stepper-circle",{"bs-stepper-circle-active":t(e).current_step==1}])}," 1 ",2),ue])]),pe,s("div",me,[s("div",ye,[s("div",{class:B(["bs-stepper-circle",{"bs-stepper-circle-active":t(e).current_step==2}])}," 2 ",2),be])]),ge,s("div",he,[s("div",ve,[s("div",{class:B(["bs-stepper-circle",{"bs-stepper-circle-active":t(e).current_step==3}])}," 3 ",2),fe])])])]),s("div",xe,[t(e).current_step==1?(a(),_("div",ke,[s("div",Ve,[Pe,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[0]||(o[0]=l=>t(e).client_id=l)},[(a(!0),_(b,null,g(x.value,l=>(a(),_("option",{key:l.id,value:l.id},i(l.name),9,Ce))),128))],512),[[u,t(e).client_id]]),n(c,{message:t(e).errors.client_id},null,8,["message"])]),s("div",Se,[we,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[1]||(o[1]=l=>t(e).insurer_id=l)},[(a(!0),_(b,null,g(k.value,l=>(a(),_("option",{key:l.id,value:l.id},i(l.name),9,Ue))),128))],512),[[u,t(e).insurer_id]]),n(c,{message:t(e).errors.insurer_id},null,8,["message"])]),s("div",Be,[Ne,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[2]||(o[2]=l=>t(e).insurance_type=l)},Ee,512),[[u,t(e).insurance_type]]),n(c,{message:t(e).errors.insurance_type},null,8,["message"])]),s("div",Le,[Ae,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[3]||(o[3]=l=>t(e).lead_type=l)},ze,512),[[u,t(e).lead_type]]),n(c,{message:t(e).errors.lead_type},null,8,["message"])]),s("div",Fe,[Ke,d(s("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":o[4]||(o[4]=l=>t(e).co_insurance=l),disabled:t(e).lead_type==="2"},null,8,Me),[[y,t(e).co_insurance]]),n(c,{message:t(e).errors.co_insurance},null,8,["message"])]),s("div",Oe,[je,d(s("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":o[5]||(o[5]=l=>t(e).policy_no=l)},null,512),[[y,t(e).policy_no]]),n(c,{message:t(e).errors.policy_no},null,8,["message"])]),s("div",Ge,[He,d(s("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":o[6]||(o[6]=l=>t(e).cover_note_no=l)},null,512),[[y,t(e).cover_note_no]]),n(c,{message:t(e).errors.cover_note_no},null,8,["message"])]),s("div",Xe,[qe,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[7]||(o[7]=l=>t(e).agency_id=l)},[(a(!0),_(b,null,g(V.value,l=>(a(),_("option",{key:l.id,value:l.id},i(l.name),9,Je))),128))],512),[[u,t(e).agency_id]]),n(c,{message:t(e).errors.agency_id},null,8,["message"])]),s("div",Qe,[We,d(s("select",{id:"departmentSelect",class:"form-select","onUpdate:modelValue":o[8]||(o[8]=l=>t(e).department_id=l),onChange:K},[(a(!0),_(b,null,g(C.value,l=>(a(),_("option",{value:l.id},i(l.name),9,Ye))),256))],544),[[u,t(e).department_id]]),n(c,{message:t(e).errors.department_id},null,8,["message"])]),s("div",Ze,[es,d(s("select",{id:"businessClassSelect",class:"form-select","onUpdate:modelValue":o[9]||(o[9]=l=>t(e).cob_id=l),onChange:H},[(a(!0),_(b,null,g(P.value,l=>(a(),_("option",{value:l.id},i(l.class_name),9,ss))),256))],544),[[u,t(e).cob_id]]),n(c,{message:t(e).errors.cob_id},null,8,["message"])]),s("div",ts,[os,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[10]||(o[10]=l=>t(e).policy_type=l)},cs,512),[[u,t(e).policy_type]]),n(c,{message:t(e).errors.policy_type},null,8,["message"])]),s("div",as,[_s,n(t(D),{modelValue:t(e).date_of_issuance,"onUpdate:modelValue":o[11]||(o[11]=l=>t(e).date_of_issuance=l),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(e).errors.date_of_issuance},null,8,["message"])]),s("div",ds,[us,n(t(D),{modelValue:t(e).policy_period_start,"onUpdate:modelValue":o[12]||(o[12]=l=>t(e).policy_period_start=l),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(e).errors.policy_period_start},null,8,["message"])]),s("div",ps,[ms,n(t(D),{modelValue:t(e).policy_period_end,"onUpdate:modelValue":o[13]||(o[13]=l=>t(e).policy_period_end=l),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(e).errors.policy_period_end},null,8,["message"])]),s("div",ys,[bs,d(s("select",{id:"input21",class:"form-select","onUpdate:modelValue":o[14]||(o[14]=l=>t(e).installment_plan=l)},fs,512),[[u,t(e).installment_plan]]),n(c,{message:t(e).errors.installment_plan},null,8,["message"])])])):m("",!0),t(e).current_step==2?(a(),_("div",xs,[s("div",ks,[s("div",Vs,[s("table",Ps,[s("tr",Cs,[Ss,s("td",null,[d(s("input",{type:"number",class:"form-control",id:"sum_insured","onUpdate:modelValue":o[15]||(o[15]=l=>t(e).sum_insured=l)},null,512),[[y,t(e).sum_insured]]),n(c,{message:t(e).errors.sum_insured},null,8,["message"])])]),s("tr",ws,[Us,s("td",null,[d(s("input",{type:"number",class:"form-control",id:"gross_premium","onUpdate:modelValue":o[16]||(o[16]=l=>t(e).gross_premium=l),onInput:U},null,544),[[y,t(e).gross_premium]]),n(c,{message:t(e).errors.gross_premium},null,8,["message"])])]),s("tr",Bs,[Ns,s("td",null,[d(s("input",{type:"number",class:"form-control",id:"net_premium","onUpdate:modelValue":o[17]||(o[17]=l=>t(e).net_premium=l)},null,512),[[y,t(e).net_premium]]),n(c,{message:t(e).errors.net_premium},null,8,["message"])])]),s("tr",Ds,[Is,s("td",null,[d(s("input",{type:"number",class:"form-control",id:"percentage","onUpdate:modelValue":o[18]||(o[18]=l=>t(e).rate_percentage=l),readonly:""},null,512),[[y,t(e).rate_percentage]]),n(c,{message:t(e).errors.rate_percentage},null,8,["message"])])]),s("tr",Es,[Ls,s("td",null,[d(s("input",{type:"number",class:"form-control",id:"brokerage_amount","onUpdate:modelValue":o[19]||(o[19]=l=>t(e).brokerage_amount=l)},null,512),[[y,t(e).brokerage_amount]]),n(c,{message:t(e).errors.brokerage_amount},null,8,["message"])])])])])])])):m("",!0),t(e).current_step==3?(a(),_(b,{key:2},[s("div",As,[s("table",$s,[Rs,s("tr",null,[Ts,s("td",null,i(t(e).client_id),1),zs,s("td",null,i(t(e).insurer_id),1)]),s("tr",null,[Fs,s("td",null,i(t(e).insurance_type),1),Ks,s("td",null,i(t(e).lead_type),1)]),s("tr",null,[Ms,s("td",null,i(t(e).co_insurance),1),Os,s("td",null,i(t(e).policy_no),1)]),s("tr",null,[js,s("td",null,i(t(e).agency_id),1),Gs,s("td",null,i(t(e).department_id),1)]),s("tr",null,[Hs,s("td",null,i(t(e).cob_id),1),Xs,s("td",null,i(t(e).policy_type),1)]),s("tr",null,[qs,s("td",null,i(t(e).cover_note_no),1),Js,s("td",null,i(t(e).installment_plan),1)])])]),s("div",Qs,[s("table",Ws,[Ys,s("tr",null,[Zs,s("td",null," PKR "+i(t(e).sum_insured.toLocaleString()),1),et,s("td",null," PKR "+i(t(e).gross_premium.toLocaleString()),1)]),s("tr",null,[st,s("td",null," PKR "+i(t(e).net_premium.toLocaleString()),1),tt,s("td",null,i(t(e).rate_percentage)+" % ",1)]),s("tr",null,[ot,s("td",null," PKR "+i(t(e).brokerage_amount.toLocaleString()),1)])])])],64)):m("",!0)]),s("div",lt,[s("div",nt,[s("div",it,[[2,3].includes(t(e).current_step)?(a(),_("button",{key:0,class:"btn btn-outline-secondary px-4",type:"button",onClick:M},[rt,N("Previous")])):m("",!0),[1,2].includes(t(e).current_step)?(a(),_("button",{key:1,class:"btn btn-primary px-4",type:"button",onClick:O},[N("Next"),ct])):m("",!0),t(e).current_step==3?(a(),_("button",at,"Save & Submit")):m("",!0)])])])])])])],32)])])])):m("",!0)]))}};export{yt as default};
