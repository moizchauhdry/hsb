import{q as p,v as T,A,c as a,a as n,w as z,b as e,g as H,n as E,u as t,j as d,D as u,F as y,r as g,E as m,h,t as i,f as N,G as f,o as _}from"./app-95a44027.js";import{_ as c}from"./InputError-92a85cae.js";import{Z as B}from"./vue-datepicker-4f2e3b87.js";/* empty css             */import{_ as Z}from"./PrimaryButton-cf245051.js";const q={class:"col"},J={key:0,class:"modal fade show",id:"exampleLargeModal",tabindex:"-1","aria-hidden":"true",style:{display:"block"}},Q={class:"modal-dialog modal-lg"},W={class:"modal-content"},X=e("h5",{class:"modal-title"},"Policies",-1),Y={class:"modal-body"},ee={id:"stepper1",class:"bs-stepper"},se={class:"card"},te={class:"card-header"},le={class:"d-lg-flex flex-lg-row align-items-lg-center justify-content-lg-between",role:"tablist"},oe={class:"step"},ne={class:"step-trigger",role:"tab"},ie=e("div",{class:""},[e("h5",{class:"mb-0 steper-title"},"Policy Info "),e("p",{class:"mb-0 steper-sub-title"},"Enter Policy Details")],-1),re=e("div",{class:"bs-stepper-line"},null,-1),ce={class:"step"},ae={class:"step-trigger",role:"tab"},_e=e("div",{class:""},[e("h5",{class:"mb-0 steper-title"},"Policy Amount"),e("p",{class:"mb-0 steper-sub-title"},"Setup Policy Amount")],-1),de=e("div",{class:"bs-stepper-line"},null,-1),ue={class:"step"},pe={class:"step-trigger",role:"tab"},me=e("div",{class:""},[e("h5",{class:"mb-0 steper-title"},"Confirmation"),e("p",{class:"mb-0 steper-sub-title"},"Policy Confirmation")],-1),he={class:"card-body"},ye={key:0,class:"row g-2"},ge={class:"col-md-4"},be=e("label",{for:"input13",class:"form-label"},"Client",-1),fe=["value"],ve={class:"col-md-4"},xe=e("label",{for:"input21",class:"form-label"},"Insurer",-1),ke=["value"],Pe={class:"col-md-4"},Ve=e("label",{for:"input21",class:"form-label"},"Insurance type",-1),Ce=e("option",{value:"1"},"Takaful",-1),we=e("option",{value:"2"},"Conventional",-1),Se=[Ce,we],Ue={class:"col-md-4"},Ee=e("label",{for:"input21",class:"form-label"},"Lead type",-1),Ne=e("option",{value:"1"},"Direct 100%",-1),Be=e("option",{value:"2"},"Our lead",-1),De=e("option",{value:"3"},"Other lead",-1),Ie=[Ne,Be,De],Le={class:"col-md-4"},Ae=e("label",{for:"input13",class:"form-label"},"Co insurance",-1),Re=["disabled"],$e={class:"col-md-4"},Fe=e("label",{for:"input13",class:"form-label"},"Policy No",-1),Ke={class:"col-md-4"},Me=e("label",{for:"input13",class:"form-label"},"Cover note no",-1),Oe={class:"col-md-4"},je=e("label",{for:"input21",class:"form-label"},"Agency",-1),Ge=["value"],Te={class:"col-md-4"},ze=e("label",{for:"departmentSelect",class:"form-label"},"Department",-1),He=["value"],Ze={class:"col-md-4"},qe=e("label",{for:"businessClassSelect",class:"form-label"},"Business Class",-1),Je=["value"],Qe={class:"col-md-4"},We=e("label",{for:"input21",class:"form-label"},"New/Renewal/Endorsment",-1),Xe=e("option",{value:"new"},"New",-1),Ye=e("option",{value:"renewal"},"Renewal",-1),es=e("option",{value:"endorsment"},"Endorsment",-1),ss=e("option",{value:"others"},"Others",-1),ts=[Xe,Ye,es,ss],ls={class:"col-md-4"},os=e("label",{for:"",class:"form-label"},"Date of Insurer",-1),ns={class:"col-md-4"},is=e("label",{for:"input13",class:"form-label"},"Policy start period",-1),rs={class:"col-md-4"},cs=e("label",{for:"input13",class:"form-label"},"Policy end period",-1),as={class:"col-md-4"},_s=e("label",{for:"input13",class:"form-label"},"Installment plan",-1),ds=e("option",{value:"2"},"2",-1),us=e("option",{value:"4"},"4",-1),ps=[ds,us],ms={key:1,class:"row g-2"},hs={class:"border mb-4",id:"partner"},ys={class:"table-responsive"},gs={class:"table",style:{"margin-top":"10px","margin-bottom":"10px"}},bs={style:{"text-align":"center"}},fs=e("th",null,"Sum insured",-1),vs={style:{"text-align":"center"}},xs=e("th",null,"Gross premium",-1),ks={style:{"text-align":"center"}},Ps=e("th",null,"Net premium",-1),Vs={style:{"text-align":"center"}},Cs=e("th",null,"Percentage",-1),ws={style:{"text-align":"center"}},Ss=e("th",null,"HSB Profit",-1),Us=e("h6",null,"Please finalize data.",-1),Es={class:"table-responsive",style:{"overflow-x":"hidden"}},Ns={class:"container-fluid"},Bs={class:"border mb-4",id:"partner"},Ds=e("div",{style:{"background-color":"#037DE2"}},[e("h5",{style:{"text-align":"center"},class:"w-auto title"},"Policy Info")],-1),Is={class:"row"},Ls={class:"table table-bordered",style:{"margin-left":"18px"}},As=e("th",null,"Client",-1),Rs=e("th",null,"Insurance",-1),$s=e("th",null,"Insurance type",-1),Fs=e("th",null,"Lead type",-1),Ks=e("th",null,"Co Insurance",-1),Ms=e("th",null,"Policy No.",-1),Os=e("th",null,"Agency",-1),js=e("th",null,"Department",-1),Gs=e("th",null,"Class business",-1),Ts=e("th",null,"New/Renewal/Endorsment",-1),zs=e("th",null," Cover Note No ",-1),Hs=e("th",null,"Installment Plan ",-1),Zs=e("tr",null,null,-1),qs={class:"border mb-4",id:"partner"},Js=e("div",{style:{"background-color":"#037DE2"}},[e("h5",{style:{"text-align":"center"},class:"w-auto title"},"Policy Amount")],-1),Qs={class:"row"},Ws={class:"table table-bordered",style:{"margin-left":"18px"}},Xs=e("th",null,"Sum insured ",-1),Ys=e("th",null,"Gross Premium ",-1),et=e("th",null,"Net Premium ",-1),st=e("th",null,"Percentage",-1),tt=e("th",null,"HSB profit",-1),lt={class:"card-footer"},ot={class:"col-12"},nt={class:"d-flex align-items-center gap-3"},it=e("i",{class:"bx bx-left-arrow-alt me-2"},null,-1),rt=e("i",{class:"bx bx-right-arrow-alt ms-2"},null,-1),ct={key:2,class:"btn btn-success px-4"},ht={__name:"CreateEdit",props:{policy:Object},setup(at,{expose:R}){const b=p(!1),v=p(!1),D=p([]),x=p([]),k=p([]),P=p([]),V=p([]),C=p([]),s=T({current_step:1,total_step:3,policy_id:"",client_id:"",insurance_id:"",co_insurance:"",takeful_type:"",lead_type:"",department_id:"",policy_no:"",agency_id:"",agency_code:"",class_of_business_id:"",orignal_endorsment:"",date_of_insurance:"",policy_start_period:"",policy_end_period:"",sum_insured:"",gross_premium:"",net_premium:"",cover_note_no:"",installment_plan:"",leader:"",leader_policy_no:"",branch:"",brokerage_amount:"",tax:"",percentage:"",hsb_profit:""}),$=()=>{b.value=!0,v.value=!1,f.get("/policy/create").then(({data:r})=>{D.value=r.users,x.value=r.clients,k.value=r.insurances,P.value=r.agencies,C.value=r.departments})},F=()=>{f.get(`/policy/getDepartmentByBusinessClass/${s.department_id}`).then(({data:r})=>{V.value=r.cobs}).catch(r=>{console.error("Error fetching business classes:",r)})},I=()=>{v.value?s.post(route("policy.update"),{preserveScroll:!0,onSuccess:()=>{s.current_step++,s.current_step>3&&w()},onError:()=>L(),onFinish:()=>{}}):s.post(route("policy.store"),{preserveScroll:!0,onSuccess:()=>{s.current_step++,s.current_step>3&&w()},onError:()=>L(),onFinish:()=>{}})},L=()=>{},K=()=>{s.current_step>1&&s.current_step--},M=()=>{s.current_step<s.total_step&&I()},w=()=>{b.value=!1,s.current_step=1,s.errors={},s.policy_id="",s.client_id="",s.insurance_id="",s.co_insurance="",s.takeful_type="",s.policy_no="",s.agency_id="",s.agency_code="",s.class_of_business_id="",s.orignal_endorsment="",s.date_of_insurance="",s.policy_start_period="",s.policy_end_period="",s.sum_insured="",s.gross_premium="",s.net_premium="",s.cover_note_no="",s.installment_plan="",s.leader="",s.leader_policy_no="",s.branch="",s.brokerage_amount="",s.user_id="",s.tax="",s.percentage=""},O=r=>{b.value=!0,v.value=!0,f.get(`/policy/edit/${r}`).then(({data:l})=>{D.value=l.users,x.value=l.clients,k.value=l.insurances,P.value=l.agencies,V.value=l.cobs,C.value=l.departments,s.policy_id=l.policy.id,s.client_id=l.policy.client_id,s.insurance_id=l.policy.insurance_id,s.co_insurance=l.policy.co_insurance,s.takeful_type=l.policy.takeful_type,s.department_id=l.policy.department_id,s.lead_type=l.policy.lead_type,s.policy_no=l.policy.policy_no,s.agency_id=l.policy.agency_id,s.agency_code=l.policy.agency_code,s.class_of_business_id=l.policy.class_of_business_id,s.orignal_endorsment=l.policy.orignal_endorsment,s.date_of_insurance=l.policy.date_of_insurance,s.policy_start_period=l.policy.policy_start_period,s.policy_end_period=l.policy.policy_end_period,s.sum_insured=l.policy.sum_insured,s.gross_premium=l.policy.gross_premium,s.net_premium=l.policy.net_premium,s.cover_note_no=l.policy.cover_note_no,s.installment_plan=l.policy.installment_plan,s.leader=l.policy.leader,s.leader_policy_no=l.policy.leader_policy_no,s.branch=l.policy.branch,s.brokerage_amount=l.policy.brokerage_amount,s.tax=l.policy.tax,s.percentage=l.policy.percentage,s.hsb_profit=l.policy.hsb_profit})};R({edit:r=>O(r)});const j=()=>s.department_id===1?s.net_premium!==0?s.sum_insured/s.net_premium:null:s.department_id!==null&&s.gross_premium!==0?s.sum_insured/s.gross_premium:null;A(()=>j(),r=>{s.percentage=r});let S=null;const G=()=>{f.get(`/policy/getBusinessClassByPercent/${s.class_of_business_id}`).then(({data:r})=>{S=r.cobPercentage,s.gross_premium&&U()}).catch(r=>{console.error("Error fetching percentage:",r)})},U=()=>{S&&s.gross_premium&&(s.hsb_profit=s.gross_premium*S/100)};return A(()=>s.gross_premium,U),(r,l)=>(_(),a("div",q,[n(Z,{onClick:$},{default:z(()=>[N("Add Policy")]),_:1}),b.value?(_(),a("div",J,[e("div",Q,[e("div",W,[e("form",{onSubmit:l[20]||(l[20]=H(o=>I(),["prevent"]))},[e("div",{class:"modal-header"},[X,e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:w})]),e("div",Y,[e("div",ee,[e("div",se,[e("div",te,[e("div",le,[e("div",oe,[e("div",ne,[e("div",{class:E(["bs-stepper-circle",{"bs-stepper-circle-active":t(s).current_step==1}])}," 1 ",2),ie])]),re,e("div",ce,[e("div",ae,[e("div",{class:E(["bs-stepper-circle",{"bs-stepper-circle-active":t(s).current_step==2}])}," 2 ",2),_e])]),de,e("div",ue,[e("div",pe,[e("div",{class:E(["bs-stepper-circle",{"bs-stepper-circle-active":t(s).current_step==3}])}," 3 ",2),me])])])]),e("div",he,[t(s).current_step==1?(_(),a("div",ye,[e("div",ge,[be,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[0]||(l[0]=o=>t(s).client_id=o)},[(_(!0),a(y,null,g(x.value,o=>(_(),a("option",{key:o.id,value:o.id},i(o.name),9,fe))),128))],512),[[u,t(s).client_id]]),n(c,{message:t(s).errors.client_id},null,8,["message"])]),e("div",ve,[xe,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[1]||(l[1]=o=>t(s).insurance_id=o)},[(_(!0),a(y,null,g(k.value,o=>(_(),a("option",{key:o.id,value:o.id},i(o.name),9,ke))),128))],512),[[u,t(s).insurance_id]]),n(c,{message:t(s).errors.insurance_id},null,8,["message"])]),e("div",Pe,[Ve,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[2]||(l[2]=o=>t(s).takeful_type=o)},Se,512),[[u,t(s).takeful_type]]),n(c,{message:t(s).errors.takeful_type},null,8,["message"])]),e("div",Ue,[Ee,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[3]||(l[3]=o=>t(s).lead_type=o)},Ie,512),[[u,t(s).lead_type]]),n(c,{message:t(s).errors.lead_type},null,8,["message"])]),e("div",Le,[Ae,d(e("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":l[4]||(l[4]=o=>t(s).co_insurance=o),disabled:t(s).lead_type==="2"},null,8,Re),[[m,t(s).co_insurance]]),n(c,{message:t(s).errors.co_insurance},null,8,["message"])]),e("div",$e,[Fe,d(e("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":l[5]||(l[5]=o=>t(s).policy_no=o)},null,512),[[m,t(s).policy_no]]),n(c,{message:t(s).errors.policy_no},null,8,["message"])]),e("div",Ke,[Me,d(e("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":l[6]||(l[6]=o=>t(s).cover_note_no=o)},null,512),[[m,t(s).cover_note_no]]),n(c,{message:t(s).errors.cover_note_no},null,8,["message"])]),e("div",Oe,[je,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[7]||(l[7]=o=>t(s).agency_id=o)},[(_(!0),a(y,null,g(P.value,o=>(_(),a("option",{key:o.id,value:o.id},i(o.name),9,Ge))),128))],512),[[u,t(s).agency_id]]),n(c,{message:t(s).errors.agency_id},null,8,["message"])]),e("div",Te,[ze,d(e("select",{id:"departmentSelect",class:"form-select","onUpdate:modelValue":l[8]||(l[8]=o=>t(s).department_id=o),onChange:F},[(_(!0),a(y,null,g(C.value,o=>(_(),a("option",{value:o.id},i(o.name),9,He))),256))],544),[[u,t(s).department_id]]),n(c,{message:t(s).errors.department_id},null,8,["message"])]),e("div",Ze,[qe,d(e("select",{id:"businessClassSelect",class:"form-select","onUpdate:modelValue":l[9]||(l[9]=o=>t(s).class_of_business_id=o),onChange:G},[(_(!0),a(y,null,g(V.value,o=>(_(),a("option",{value:o.id},i(o.class_name),9,Je))),256))],544),[[u,t(s).class_of_business_id]]),n(c,{message:t(s).errors.class_of_business_id},null,8,["message"])]),e("div",Qe,[We,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[10]||(l[10]=o=>t(s).orignal_endorsment=o)},ts,512),[[u,t(s).orignal_endorsment]]),n(c,{message:t(s).errors.orignal_endorsment},null,8,["message"])]),e("div",ls,[os,n(t(B),{modelValue:t(s).date_of_insurance,"onUpdate:modelValue":l[11]||(l[11]=o=>t(s).date_of_insurance=o),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(s).errors.date_of_insurance},null,8,["message"])]),e("div",ns,[is,n(t(B),{modelValue:t(s).policy_start_period,"onUpdate:modelValue":l[12]||(l[12]=o=>t(s).policy_start_period=o),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(s).errors.policy_start_period},null,8,["message"])]),e("div",rs,[cs,n(t(B),{modelValue:t(s).policy_end_period,"onUpdate:modelValue":l[13]||(l[13]=o=>t(s).policy_end_period=o),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(s).errors.policy_end_period},null,8,["message"])]),e("div",as,[_s,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[14]||(l[14]=o=>t(s).installment_plan=o)},ps,512),[[u,t(s).installment_plan]]),n(c,{message:t(s).errors.installment_plan},null,8,["message"])])])):h("",!0),t(s).current_step==2?(_(),a("div",ms,[e("div",hs,[e("div",ys,[e("table",gs,[e("tr",bs,[fs,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"sum_insured","onUpdate:modelValue":l[15]||(l[15]=o=>t(s).sum_insured=o)},null,512),[[m,t(s).sum_insured]]),n(c,{message:t(s).errors.sum_insured},null,8,["message"])])]),e("tr",vs,[xs,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"gross_premium","onUpdate:modelValue":l[16]||(l[16]=o=>t(s).gross_premium=o),onInput:U},null,544),[[m,t(s).gross_premium]]),n(c,{message:t(s).errors.gross_premium},null,8,["message"])])]),e("tr",ks,[Ps,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"net_premium","onUpdate:modelValue":l[17]||(l[17]=o=>t(s).net_premium=o)},null,512),[[m,t(s).net_premium]]),n(c,{message:t(s).errors.net_premium},null,8,["message"])])]),e("tr",Vs,[Cs,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"percentage","onUpdate:modelValue":l[18]||(l[18]=o=>t(s).percentage=o),readonly:""},null,512),[[m,t(s).percentage]]),n(c,{message:t(s).errors.percentage},null,8,["message"])])]),e("tr",ws,[Ss,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"hsb_profit","onUpdate:modelValue":l[19]||(l[19]=o=>t(s).hsb_profit=o)},null,512),[[m,t(s).hsb_profit]]),n(c,{message:t(s).errors.hsb_profit},null,8,["message"])])])])])])])):h("",!0),t(s).current_step==3?(_(),a(y,{key:2},[Us,e("div",Es,[e("div",Ns,[e("div",Bs,[Ds,e("div",Is,[e("table",Ls,[e("tr",null,[As,e("td",null,i(t(s).client_id),1),Rs,e("td",null,i(t(s).insurance_id),1)]),e("tr",null,[$s,e("td",null,i(t(s).takeful_type),1),Fs,e("td",null,i(t(s).lead_type),1)]),e("tr",null,[Ks,e("td",null,i(t(s).co_insurance),1),Ms,e("td",null,i(t(s).policy_no),1)]),e("tr",null,[Os,e("td",null,i(t(s).agency_id),1),js,e("td",null,i(t(s).department_id),1)]),e("tr",null,[Gs,e("td",null,i(t(s).class_of_business_id),1),Ts,e("td",null,i(t(s).orignal_endorsment),1)]),e("tr",null,[zs,e("td",null,i(t(s).cover_note_no),1),Hs,e("td",null,i(t(s).installment_plan),1)]),Zs])])]),e("div",qs,[Js,e("div",Qs,[e("table",Ws,[e("tr",null,[Xs,e("td",null," PKR "+i(t(s).sum_insured.toLocaleString()),1),Ys,e("td",null," PKR "+i(t(s).gross_premium.toLocaleString()),1)]),e("tr",null,[et,e("td",null," PKR "+i(t(s).net_premium.toLocaleString()),1),st,e("td",null,i(t(s).percentage)+" % ",1)]),e("tr",null,[tt,e("td",null," PKR "+i(t(s).hsb_profit.toLocaleString()),1)])])])])])])],64)):h("",!0)]),e("div",lt,[e("div",ot,[e("div",nt,[[2,3].includes(t(s).current_step)?(_(),a("button",{key:0,class:"btn btn-outline-secondary px-4",type:"button",onClick:K},[it,N("Previous")])):h("",!0),[1,2].includes(t(s).current_step)?(_(),a("button",{key:1,class:"btn btn-primary px-4",type:"button",onClick:M},[N("Next"),rt])):h("",!0),t(s).current_step==3?(_(),a("button",ct,"Submit")):h("",!0)])])])])])])],32)])])])):h("",!0)]))}};export{ht as default};
