import{J as z,q as p,v as H,B as R,c as _,u as t,e as Z,w as q,h as m,b as e,g as J,n as B,j as d,E as u,F as y,r as b,a as n,s as h,t as i,f as E,G as f,o as a}from"./app-c12c7805.js";import{_ as c}from"./InputError-5286ca68.js";import{Z as N}from"./vue-datepicker-4e98a90a.js";/* empty css             */import{_ as Q}from"./SuccessButton-f4775c80.js";const W={class:"col"},X=e("i",{class:"bx bx-plus text-lg"},null,-1),Y={key:1,class:"modal fade show",id:"exampleLargeModal",tabindex:"-1","aria-hidden":"true",style:{display:"block"}},ee={class:"modal-dialog modal-lg"},se={class:"modal-content"},te=e("h5",{class:"modal-title"},"Policies",-1),le={class:"modal-body"},oe={id:"stepper1",class:"bs-stepper"},ne={class:"card"},ie={class:"card-header"},re={class:"d-lg-flex flex-lg-row align-items-lg-center justify-content-lg-between",role:"tablist"},ce={class:"step"},ae={class:"step-trigger",role:"tab"},_e=e("div",{class:""},[e("h5",{class:"mb-0 steper-title"},"Policy Info "),e("p",{class:"mb-0 steper-sub-title"},"Enter Policy Details")],-1),de=e("div",{class:"bs-stepper-line"},null,-1),ue={class:"step"},pe={class:"step-trigger",role:"tab"},me=e("div",{class:""},[e("h5",{class:"mb-0 steper-title"},"Policy Amount"),e("p",{class:"mb-0 steper-sub-title"},"Setup Policy Amount")],-1),he=e("div",{class:"bs-stepper-line"},null,-1),ye={class:"step"},be={class:"step-trigger",role:"tab"},ge=e("div",{class:""},[e("h5",{class:"mb-0 steper-title"},"Confirmation"),e("p",{class:"mb-0 steper-sub-title"},"Policy Confirmation")],-1),fe={class:"card-body"},ve={key:0,class:"row g-2"},xe={class:"col-md-4"},ke=e("label",{for:"input13",class:"form-label"},"Client",-1),Ve=["value"],we={class:"col-md-4"},Ce=e("label",{for:"input21",class:"form-label"},"Insurer",-1),Pe=["value"],Se={class:"col-md-4"},Ue=e("label",{for:"input21",class:"form-label"},"Insurance type",-1),Be=e("option",{value:"1"},"Takaful",-1),Ee=e("option",{value:"2"},"Conventional",-1),Ne=[Be,Ee],De={class:"col-md-4"},Ie=e("label",{for:"input21",class:"form-label"},"Lead type",-1),Le=e("option",{value:"1"},"Direct 100%",-1),Re=e("option",{value:"2"},"Our lead",-1),Ae=e("option",{value:"3"},"Other lead",-1),$e=[Le,Re,Ae],Fe={class:"col-md-4"},Ke=e("label",{for:"input13",class:"form-label"},"Co insurance",-1),Me=["disabled"],Oe={class:"col-md-4"},je=e("label",{for:"input13",class:"form-label"},"Policy No",-1),Ge={class:"col-md-4"},Te=e("label",{for:"input13",class:"form-label"},"Cover note no",-1),ze={class:"col-md-4"},He=e("label",{for:"input21",class:"form-label"},"Agency",-1),Ze=["value"],qe={class:"col-md-4"},Je=e("label",{for:"departmentSelect",class:"form-label"},"Department",-1),Qe=["value"],We={class:"col-md-4"},Xe=e("label",{for:"businessClassSelect",class:"form-label"},"Business Class",-1),Ye=["value"],es={class:"col-md-4"},ss=e("label",{for:"input21",class:"form-label"},"New/Renewal/Endorsement",-1),ts=e("option",{value:"new"},"New",-1),ls=e("option",{value:"renewal"},"Renewal",-1),os=e("option",{value:"endorsment"},"Endorsement",-1),ns=e("option",{value:"others"},"Others",-1),is=[ts,ls,os,ns],rs={class:"col-md-4"},cs=e("label",{for:"",class:"form-label"},"Date of Insurer",-1),as={class:"col-md-4"},_s=e("label",{for:"input13",class:"form-label"},"Inception Date",-1),ds={class:"col-md-4"},us=e("label",{for:"input13",class:"form-label"},"Expiry Date",-1),ps={class:"col-md-4"},ms=e("label",{for:"input13",class:"form-label"},"Installment plan",-1),hs=e("option",{value:"2"},"2",-1),ys=e("option",{value:"3"},"3",-1),bs=e("option",{value:"4"},"4",-1),gs=[hs,ys,bs],fs={key:1,class:"row g-2"},vs={class:"border mb-4",id:"partner"},xs={class:"table-responsive"},ks={class:"table",style:{"margin-top":"10px","margin-bottom":"10px"}},Vs={style:{"text-align":"center"}},ws=e("th",null,"Sum insured",-1),Cs={style:{"text-align":"center"}},Ps=e("th",null,"Gross premium",-1),Ss={style:{"text-align":"center"}},Us=e("th",null,"Net premium",-1),Bs={style:{"text-align":"center"}},Es=e("th",null,"Percentage",-1),Ns={style:{"text-align":"center"}},Ds=e("th",null,"HSB Profit",-1),Is=e("h6",null,"Please finalize data.",-1),Ls={class:"table-responsive",style:{"overflow-x":"hidden"}},Rs={class:"container-fluid"},As={class:"border mb-4",id:"partner"},$s=e("div",{style:{"background-color":"#037DE2"}},[e("h5",{style:{"text-align":"center"},class:"w-auto title"},"Policy Info")],-1),Fs={class:"row"},Ks={class:"table table-bordered",style:{"margin-left":"18px"}},Ms=e("th",null,"Client",-1),Os=e("th",null,"Insurance",-1),js=e("th",null,"Insurance type",-1),Gs=e("th",null,"Lead type",-1),Ts=e("th",null,"Co Insurance",-1),zs=e("th",null,"Policy No.",-1),Hs=e("th",null,"Agency",-1),Zs=e("th",null,"Department",-1),qs=e("th",null,"Class business",-1),Js=e("th",null,"New/Renewal/Endorsment",-1),Qs=e("th",null," Cover Note No ",-1),Ws=e("th",null,"Installment Plan ",-1),Xs=e("tr",null,null,-1),Ys={class:"border mb-4",id:"partner"},et=e("div",{style:{"background-color":"#037DE2"}},[e("h5",{style:{"text-align":"center"},class:"w-auto title"},"Policy Amount")],-1),st={class:"row"},tt={class:"table table-bordered",style:{"margin-left":"18px"}},lt=e("th",null,"Sum insured ",-1),ot=e("th",null,"Gross Premium ",-1),nt=e("th",null,"Net Premium ",-1),it=e("th",null,"Percentage",-1),rt=e("th",null,"HSB profit",-1),ct={class:"card-footer"},at={class:"col-12"},_t={class:"d-flex align-items-center gap-3"},dt=e("i",{class:"bx bx-left-arrow-alt me-2"},null,-1),ut=e("i",{class:"bx bx-right-arrow-alt ms-2"},null,-1),pt={key:2,class:"btn btn-success px-4"},vt={__name:"CreateEdit",props:{policy:Object},setup(mt,{expose:A}){const $=z().props.can,g=p(!1),v=p(!1),D=p([]),x=p([]),k=p([]),V=p([]),w=p([]),C=p([]),s=H({current_step:1,total_step:3,policy_id:"",client_id:"",insurance_id:"",co_insurance:"",takeful_type:"",lead_type:"",department_id:"",policy_no:"",agency_id:"",agency_code:"",class_of_business_id:"",orignal_endorsment:"",date_of_insurance:"",policy_period_start:"",policy_period_end:"",sum_insured:"",gross_premium:"",net_premium:"",cover_note_no:"",installment_plan:"",leader:"",leader_policy_no:"",branch:"",brokerage_amount:"",tax:"",percentage:"",hsb_profit:""}),F=()=>{g.value=!0,v.value=!1,f.get("/policy/create").then(({data:r})=>{D.value=r.users,x.value=r.clients,k.value=r.insurances,V.value=r.agencies,C.value=r.departments})},K=()=>{f.get(`/policy/getDepartmentByBusinessClass/${s.department_id}`).then(({data:r})=>{w.value=r.cobs}).catch(r=>{console.error("Error fetching business classes:",r)})},I=()=>{v.value?s.post(route("policy.update"),{preserveScroll:!0,onSuccess:()=>{s.current_step++,s.current_step>3&&P()},onError:()=>L(),onFinish:()=>{}}):s.post(route("policy.store"),{preserveScroll:!0,onSuccess:()=>{s.current_step++,s.current_step>3&&P()},onError:()=>L(),onFinish:()=>{}})},L=()=>{},M=()=>{s.current_step>1&&s.current_step--},O=()=>{s.current_step<s.total_step&&I()},P=()=>{g.value=!1,s.current_step=1,s.errors={},s.policy_id="",s.client_id="",s.insurance_id="",s.co_insurance="",s.takeful_type="",s.policy_no="",s.agency_id="",s.agency_code="",s.class_of_business_id="",s.orignal_endorsment="",s.date_of_insurance="",s.policy_period_start="",s.policy_period_end="",s.sum_insured="",s.gross_premium="",s.net_premium="",s.cover_note_no="",s.installment_plan="",s.leader="",s.leader_policy_no="",s.branch="",s.brokerage_amount="",s.user_id="",s.tax="",s.percentage=""},j=r=>{g.value=!0,v.value=!0,f.get(`/policy/edit/${r}`).then(({data:l})=>{D.value=l.users,x.value=l.clients,k.value=l.insurances,V.value=l.agencies,w.value=l.cobs,C.value=l.departments,s.policy_id=l.policy.id,s.client_id=l.policy.client_id,s.insurance_id=l.policy.insurance_id,s.co_insurance=l.policy.co_insurance,s.takeful_type=l.policy.takeful_type,s.department_id=l.policy.department_id,s.lead_type=l.policy.lead_type,s.policy_no=l.policy.policy_no,s.agency_id=l.policy.agency_id,s.agency_code=l.policy.agency_code,s.class_of_business_id=l.policy.class_of_business_id,s.orignal_endorsment=l.policy.orignal_endorsment,s.date_of_insurance=l.policy.date_of_insurance,s.policy_period_start=l.policy.policy_period_start,s.policy_period_end=l.policy.policy_period_end,s.sum_insured=l.policy.sum_insured,s.gross_premium=l.policy.gross_premium,s.net_premium=l.policy.net_premium,s.cover_note_no=l.policy.cover_note_no,s.installment_plan=l.policy.installment_plan,s.leader=l.policy.leader,s.leader_policy_no=l.policy.leader_policy_no,s.branch=l.policy.branch,s.brokerage_amount=l.policy.brokerage_amount,s.tax=l.policy.tax,s.percentage=l.policy.percentage,s.hsb_profit=l.policy.hsb_profit})};A({edit:r=>j(r)});const G=()=>s.department_id===1?s.net_premium!==0?s.sum_insured/s.net_premium:null:s.department_id!==null&&s.gross_premium!==0?s.sum_insured/s.gross_premium:null;R(()=>G(),r=>{s.percentage=r});let S=null;const T=()=>{f.get(`/policy/getBusinessClassByPercent/${s.class_of_business_id}`).then(({data:r})=>{S=r.cobPercentage,s.gross_premium&&U()}).catch(r=>{console.error("Error fetching percentage:",r)})},U=()=>{S&&s.gross_premium&&(s.hsb_profit=s.gross_premium*S/100)};return R(()=>s.gross_premium,U),(r,l)=>(a(),_("div",W,[t($).policy_create?(a(),Z(Q,{key:0,onClick:F,class:"mr-1"},{default:q(()=>[X,E(" Add Policy")]),_:1})):m("",!0),g.value?(a(),_("div",Y,[e("div",ee,[e("div",se,[e("form",{onSubmit:l[20]||(l[20]=J(o=>I(),["prevent"]))},[e("div",{class:"modal-header"},[te,e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:P})]),e("div",le,[e("div",oe,[e("div",ne,[e("div",ie,[e("div",re,[e("div",ce,[e("div",ae,[e("div",{class:B(["bs-stepper-circle",{"bs-stepper-circle-active":t(s).current_step==1}])}," 1 ",2),_e])]),de,e("div",ue,[e("div",pe,[e("div",{class:B(["bs-stepper-circle",{"bs-stepper-circle-active":t(s).current_step==2}])}," 2 ",2),me])]),he,e("div",ye,[e("div",be,[e("div",{class:B(["bs-stepper-circle",{"bs-stepper-circle-active":t(s).current_step==3}])}," 3 ",2),ge])])])]),e("div",fe,[t(s).current_step==1?(a(),_("div",ve,[e("div",xe,[ke,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[0]||(l[0]=o=>t(s).client_id=o)},[(a(!0),_(y,null,b(x.value,o=>(a(),_("option",{key:o.id,value:o.id},i(o.name),9,Ve))),128))],512),[[u,t(s).client_id]]),n(c,{message:t(s).errors.client_id},null,8,["message"])]),e("div",we,[Ce,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[1]||(l[1]=o=>t(s).insurance_id=o)},[(a(!0),_(y,null,b(k.value,o=>(a(),_("option",{key:o.id,value:o.id},i(o.name),9,Pe))),128))],512),[[u,t(s).insurance_id]]),n(c,{message:t(s).errors.insurance_id},null,8,["message"])]),e("div",Se,[Ue,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[2]||(l[2]=o=>t(s).takeful_type=o)},Ne,512),[[u,t(s).takeful_type]]),n(c,{message:t(s).errors.takeful_type},null,8,["message"])]),e("div",De,[Ie,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[3]||(l[3]=o=>t(s).lead_type=o)},$e,512),[[u,t(s).lead_type]]),n(c,{message:t(s).errors.lead_type},null,8,["message"])]),e("div",Fe,[Ke,d(e("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":l[4]||(l[4]=o=>t(s).co_insurance=o),disabled:t(s).lead_type==="2"},null,8,Me),[[h,t(s).co_insurance]]),n(c,{message:t(s).errors.co_insurance},null,8,["message"])]),e("div",Oe,[je,d(e("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":l[5]||(l[5]=o=>t(s).policy_no=o)},null,512),[[h,t(s).policy_no]]),n(c,{message:t(s).errors.policy_no},null,8,["message"])]),e("div",Ge,[Te,d(e("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":l[6]||(l[6]=o=>t(s).cover_note_no=o)},null,512),[[h,t(s).cover_note_no]]),n(c,{message:t(s).errors.cover_note_no},null,8,["message"])]),e("div",ze,[He,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[7]||(l[7]=o=>t(s).agency_id=o)},[(a(!0),_(y,null,b(V.value,o=>(a(),_("option",{key:o.id,value:o.id},i(o.name),9,Ze))),128))],512),[[u,t(s).agency_id]]),n(c,{message:t(s).errors.agency_id},null,8,["message"])]),e("div",qe,[Je,d(e("select",{id:"departmentSelect",class:"form-select","onUpdate:modelValue":l[8]||(l[8]=o=>t(s).department_id=o),onChange:K},[(a(!0),_(y,null,b(C.value,o=>(a(),_("option",{value:o.id},i(o.name),9,Qe))),256))],544),[[u,t(s).department_id]]),n(c,{message:t(s).errors.department_id},null,8,["message"])]),e("div",We,[Xe,d(e("select",{id:"businessClassSelect",class:"form-select","onUpdate:modelValue":l[9]||(l[9]=o=>t(s).class_of_business_id=o),onChange:T},[(a(!0),_(y,null,b(w.value,o=>(a(),_("option",{value:o.id},i(o.class_name),9,Ye))),256))],544),[[u,t(s).class_of_business_id]]),n(c,{message:t(s).errors.class_of_business_id},null,8,["message"])]),e("div",es,[ss,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[10]||(l[10]=o=>t(s).orignal_endorsment=o)},is,512),[[u,t(s).orignal_endorsment]]),n(c,{message:t(s).errors.orignal_endorsment},null,8,["message"])]),e("div",rs,[cs,n(t(N),{modelValue:t(s).date_of_insurance,"onUpdate:modelValue":l[11]||(l[11]=o=>t(s).date_of_insurance=o),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(s).errors.date_of_insurance},null,8,["message"])]),e("div",as,[_s,n(t(N),{modelValue:t(s).policy_period_start,"onUpdate:modelValue":l[12]||(l[12]=o=>t(s).policy_period_start=o),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(s).errors.policy_period_start},null,8,["message"])]),e("div",ds,[us,n(t(N),{modelValue:t(s).policy_period_end,"onUpdate:modelValue":l[13]||(l[13]=o=>t(s).policy_period_end=o),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(s).errors.policy_period_end},null,8,["message"])]),e("div",ps,[ms,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[14]||(l[14]=o=>t(s).installment_plan=o)},gs,512),[[u,t(s).installment_plan]]),n(c,{message:t(s).errors.installment_plan},null,8,["message"])])])):m("",!0),t(s).current_step==2?(a(),_("div",fs,[e("div",vs,[e("div",xs,[e("table",ks,[e("tr",Vs,[ws,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"sum_insured","onUpdate:modelValue":l[15]||(l[15]=o=>t(s).sum_insured=o)},null,512),[[h,t(s).sum_insured]]),n(c,{message:t(s).errors.sum_insured},null,8,["message"])])]),e("tr",Cs,[Ps,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"gross_premium","onUpdate:modelValue":l[16]||(l[16]=o=>t(s).gross_premium=o),onInput:U},null,544),[[h,t(s).gross_premium]]),n(c,{message:t(s).errors.gross_premium},null,8,["message"])])]),e("tr",Ss,[Us,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"net_premium","onUpdate:modelValue":l[17]||(l[17]=o=>t(s).net_premium=o)},null,512),[[h,t(s).net_premium]]),n(c,{message:t(s).errors.net_premium},null,8,["message"])])]),e("tr",Bs,[Es,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"percentage","onUpdate:modelValue":l[18]||(l[18]=o=>t(s).percentage=o),readonly:""},null,512),[[h,t(s).percentage]]),n(c,{message:t(s).errors.percentage},null,8,["message"])])]),e("tr",Ns,[Ds,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"hsb_profit","onUpdate:modelValue":l[19]||(l[19]=o=>t(s).hsb_profit=o)},null,512),[[h,t(s).hsb_profit]]),n(c,{message:t(s).errors.hsb_profit},null,8,["message"])])])])])])])):m("",!0),t(s).current_step==3?(a(),_(y,{key:2},[Is,e("div",Ls,[e("div",Rs,[e("div",As,[$s,e("div",Fs,[e("table",Ks,[e("tr",null,[Ms,e("td",null,i(t(s).client_id),1),Os,e("td",null,i(t(s).insurance_id),1)]),e("tr",null,[js,e("td",null,i(t(s).takeful_type),1),Gs,e("td",null,i(t(s).lead_type),1)]),e("tr",null,[Ts,e("td",null,i(t(s).co_insurance),1),zs,e("td",null,i(t(s).policy_no),1)]),e("tr",null,[Hs,e("td",null,i(t(s).agency_id),1),Zs,e("td",null,i(t(s).department_id),1)]),e("tr",null,[qs,e("td",null,i(t(s).class_of_business_id),1),Js,e("td",null,i(t(s).orignal_endorsment),1)]),e("tr",null,[Qs,e("td",null,i(t(s).cover_note_no),1),Ws,e("td",null,i(t(s).installment_plan),1)]),Xs])])]),e("div",Ys,[et,e("div",st,[e("table",tt,[e("tr",null,[lt,e("td",null," PKR "+i(t(s).sum_insured.toLocaleString()),1),ot,e("td",null," PKR "+i(t(s).gross_premium.toLocaleString()),1)]),e("tr",null,[nt,e("td",null," PKR "+i(t(s).net_premium.toLocaleString()),1),it,e("td",null,i(t(s).percentage)+" % ",1)]),e("tr",null,[rt,e("td",null," PKR "+i(t(s).hsb_profit.toLocaleString()),1)])])])])])])],64)):m("",!0)]),e("div",ct,[e("div",at,[e("div",_t,[[2,3].includes(t(s).current_step)?(a(),_("button",{key:0,class:"btn btn-outline-secondary px-4",type:"button",onClick:M},[dt,E("Previous")])):m("",!0),[1,2].includes(t(s).current_step)?(a(),_("button",{key:1,class:"btn btn-primary px-4",type:"button",onClick:O},[E("Next"),ut])):m("",!0),t(s).current_step==3?(a(),_("button",pt,"Submit")):m("",!0)])])])])])])],32)])])])):m("",!0)]))}};export{vt as default};
