import{J as U,e as b,f as V,o,c as a,a as p,u as c,w as D,F as h,X as j,b as t,d as f,t as l,g as m,h as v,n as I}from"./app-0973401a.js";import{_ as Y}from"./AuthenticatedLayout-c452d355.js";import{P as B}from"./Paginate-35510209.js";import{_ as F}from"./PrimaryButton-845612e0.js";import{h as P}from"./moment-a9aaa855.js";/* empty css                                               */import"./_plugin-vue_export-helper-c27b6911.js";const $={class:"page-wrapper"},z={class:"page-content"},E={class:"card"},H={class:"card-body"},K={key:0,class:"text-gray-500 text-center py-4"},R={key:1,class:"table-responsive"},T={class:"table table-bordered table-sm text-uppercase"},X={class:"px-2"},q={class:"px-2"},G={class:"px-2"},Q={class:"px-2"},W={key:0},Z={class:"table table-bordered"},tt={class:"bg-light text-dark",style:{width:"200px","text-align":"left",padding:"8px"}},st={style:{padding:"8px"}},et={class:"px-2"},lt={key:0},ot={class:"table table-bordered"},at={class:"bg-light text-dark",style:{width:"200px","text-align":"left",padding:"8px"}},nt={style:{padding:"8px"}},dt={class:"px-2"},rt={class:"card-footer d-flex justify-content-between align-items-center"},it={class:"modal-dialog modal-lg"},ct={class:"modal-content"},ut={key:0,class:"modal-body"},xt={__name:"Index",setup(_t){var A;const d=U().props,u=b(((A=d.audits)==null?void 0:A.data)||[]);V(()=>d.audits,s=>{u.value=(s==null?void 0:s.data)||[],console.log("Audits updated:",u.value)});const J=s=>P(s).format("DD-MM-YYYY HH:mm"),x=s=>{if(!s||!s.old_values)return{};try{return JSON.parse(s.old_values)}catch{return console.error("Invalid JSON format in old_values:",s.old_values),{}}},y=s=>{if(!s||!s.new_values)return{};try{return JSON.parse(s.new_values)}catch{return console.error("Invalid JSON format in new_values:",s.new_values),{}}},k=s=>s.replace(/_/g," ").toUpperCase(),w=s=>typeof s=="object"?JSON.stringify(s,null,2):s,g=b(!1),r=b(null),L=s=>{r.value={...s},g.value=!0},N=()=>{g.value=!1};return(s,e)=>(o(),a(h,null,[p(c(j),{title:"Audit Logs"}),p(Y,null,{default:D(()=>{var C,O,S;return[t("div",$,[t("div",z,[t("div",E,[e[2]||(e[2]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Audit Logs")],-1)),t("div",H,[u.value.length===0?(o(),a("div",K," No audit logs found. ")):(o(),a("div",R,[t("table",T,[e[1]||(e[1]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{class:"px-2"},"Sr#"),t("th",{class:"px-2"},"Event"),t("th",{class:"px-2"},"User"),t("th",{class:"px-2"},"Old Values"),t("th",{class:"px-2"},"New Values"),t("th",{class:"px-2"},"Date"),t("th",{class:"px-2"},"Details")])],-1)),t("tbody",null,[(o(!0),a(h,null,f(u.value,(n,M)=>(o(),a("tr",{key:n.id},[t("td",X,l(M+1),1),t("td",q,l(n.event),1),t("td",G,l(n.user_id||"Unknown"),1),t("td",Q,[Object.keys(x(n)).length?(o(),a("div",W,[t("table",Z,[t("tbody",null,[(o(!0),a(h,null,f(x(n),(_,i)=>(o(),a("tr",{key:i},[t("th",tt,l(k(i)),1),t("td",st,l(w(_)),1)]))),128))])])])):m("",!0)]),t("td",et,[Object.keys(y(n)).length?(o(),a("div",lt,[t("table",ot,[t("tbody",null,[s.key!=="user_agent"?(o(!0),a(h,{key:0},f(y(n),(_,i)=>(o(),a("tr",{key:i},[t("th",at,l(k(i)),1),t("td",nt,l(w(_)),1)]))),128)):m("",!0)])])])):m("",!0)]),t("td",dt,l(J(n.created_at)),1),t("td",null,[p(F,{color:"blue",size:"sm",onClick:_=>L(n)},{default:D(()=>e[0]||(e[0]=[v("Details")])),_:2},1032,["onClick"])])]))),128))])])]))]),t("div",rt,[t("span",null,[t("h6",null,"Showing "+l(c(d).audits.from)+" to "+l(c(d).audits.to)+" of "+l(c(d).audits.total)+" entries",1)]),p(B,{links:c(d).audits.links},null,8,["links"])])])])]),t("div",{class:I(["modal fade",{"show d-block":g.value}]),tabindex:"-1","aria-hidden":"true"},[t("div",it,[t("div",ct,[t("div",{class:"modal-header"},[e[3]||(e[3]=t("h5",{class:"modal-title"},"Audit Log Details",-1)),t("button",{type:"button",class:"btn-close",onClick:N})]),r.value?(o(),a("div",ut,[t("p",null,[e[4]||(e[4]=t("strong",null,"IP Address:",-1)),v(" "+l(((C=r.value)==null?void 0:C.ip_address)||"N/A"),1)]),t("p",null,[e[5]||(e[5]=t("strong",null,"User Agent:",-1)),v(" "+l(((O=r.value)==null?void 0:O.user_agent)||"N/A"),1)]),t("p",null,[e[6]||(e[6]=t("strong",null,"URL:",-1)),v(" "+l((S=r.value)==null?void 0:S.url),1)])])):m("",!0),t("div",{class:"modal-footer"},[t("button",{class:"btn btn-secondary",onClick:N},"Close")])])])],2)]}),_:1})],64))}};export{xt as default};
