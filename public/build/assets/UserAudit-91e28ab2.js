import{e as g,J as U,f as j,o as a,c as o,a as _,u as c,w as S,F as b,X as V,b as s,d as x,t as l,g as m,h,n as I}from"./app-2503355b.js";import{_ as Y}from"./AuthenticatedLayout-6508f512.js";import{P as z}from"./Paginate-f8f9d4be.js";import{_ as B}from"./PrimaryButton-1d84b439.js";import{h as F}from"./moment-a9aaa855.js";/* empty css                                               */import"./_plugin-vue_export-helper-c27b6911.js";const P={class:"page-wrapper"},$={class:"page-content"},E={class:"card"},H={class:"card-body"},R={key:0,class:"text-gray-500 text-center py-4"},T={key:1,class:"table-responsive"},K={class:"table table-bordered table-sm text-uppercase"},X={class:"px-2"},q={class:"px-2"},G={class:"px-2"},Q={class:"px-2"},W={class:"px-2"},Z={class:"px-2"},ss={key:0},ts={class:"table table-bordered"},es={class:"bg-light text-dark",style:{width:"200px","text-align":"left",padding:"8px"}},ls={style:{padding:"8px"}},as={class:"px-2"},os={key:0},ds={class:"table table-bordered"},ns={class:"bg-light text-dark",style:{width:"200px","text-align":"left",padding:"8px"}},rs={style:{padding:"8px"}},is={class:"px-2"},cs={class:"card-footer d-flex justify-content-between align-items-center"},us={class:"modal-dialog modal-lg"},ps={class:"modal-content"},_s={key:0,class:"modal-body"},ks={__name:"UserAudit",setup(bs){var w;const v=g(!1),r=g(null),n=U().props,u=g(((w=n.audits)==null?void 0:w.data)||[]);j(()=>n.audits,t=>{u.value=(t==null?void 0:t.data)||[],console.log("Audits updated:",u.value)});const L=t=>F(t).format("DD-MM-YYYY HH:mm"),f=t=>{if(!t||!t.old_values)return{};try{return JSON.parse(t.old_values)}catch{return console.error("Invalid JSON format in old_values:",t.old_values),{}}},y=t=>{if(!t||!t.new_values)return{};try{return JSON.parse(t.new_values)}catch{return console.error("Invalid JSON format in new_values:",t.new_values),{}}},k=t=>t.replace(/_/g," ").toUpperCase(),A=t=>typeof t=="object"?JSON.stringify(t,null,2):t,J=t=>{r.value={...t},v.value=!0},N=()=>{v.value=!1};return(t,e)=>(a(),o(b,null,[_(c(V),{title:"Audit Logs"}),_(Y,null,{default:S(()=>{var C,D,O;return[s("div",P,[s("div",$,[e[3]||(e[3]=s("div",{class:"page-breadcrumb d-sm-flex align-items-center mb-3"},[s("div",{class:"breadcrumb-title pe-3"},"Manage Audit Logs"),s("div",{class:"ps-3"},[s("nav",{"aria-label":"breadcrumb"},[s("ol",{class:"breadcrumb mb-0 p-0"},[s("li",{class:"breadcrumb-item"},[s("a",{href:"javascript:;"},[s("i",{class:"bx bx-home-alt"})])]),s("li",{class:"breadcrumb-item active text-capitalize","aria-current":"page"}," Audit Logs ")])])])],-1)),s("div",E,[e[2]||(e[2]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"Audit Logs")],-1)),s("div",H,[u.value.length===0?(a(),o("div",R," No audit logs found. ")):(a(),o("div",T,[s("table",K,[e[1]||(e[1]=s("thead",{class:"table-light"},[s("tr",null,[s("th",{class:"px-2"},"SR #"),s("th",{class:"px-2"},"Event"),s("th",{class:"px-2"},"Auditable Type"),s("th",{class:"px-2"},"Auditable ID"),s("th",{class:"px-2"},"User"),s("th",{class:"px-2"},"Old Values"),s("th",{class:"px-2"},"New Values"),s("th",{class:"px-2"},"Date"),s("th",{class:"px-2"},"Details")])],-1)),s("tbody",null,[(a(!0),o(b,null,x(u.value,(d,M)=>(a(),o("tr",{key:d.id},[s("td",X,l(M+1),1),s("td",q,l(d.event),1),s("td",G,l(d.auditable_type),1),s("td",Q,l(d.auditable_id),1),s("td",W,l(d.user_id||"Unknown"),1),s("td",Z,[Object.keys(f(d)).length?(a(),o("div",ss,[s("table",ts,[s("tbody",null,[(a(!0),o(b,null,x(f(d),(p,i)=>(a(),o("tr",{key:i},[s("th",es,l(k(i)),1),s("td",ls,l(A(p)),1)]))),128))])])])):m("",!0)]),s("td",as,[Object.keys(y(d)).length?(a(),o("div",os,[s("table",ds,[s("tbody",null,[t.key!=="user_agent"?(a(!0),o(b,{key:0},x(y(d),(p,i)=>(a(),o("tr",{key:i},[s("th",ns,l(k(i)),1),s("td",rs,l(A(p)),1)]))),128)):m("",!0)])])])):m("",!0)]),s("td",is,l(L(d.created_at)),1),s("td",null,[_(B,{color:"blue",size:"sm",onClick:p=>J(d)},{default:S(()=>e[0]||(e[0]=[h("Details ")])),_:2},1032,["onClick"])])]))),128))])])]))]),s("div",cs,[s("span",null,[s("h6",null,"Showing "+l(c(n).audits.from)+" to "+l(c(n).audits.to)+" of "+l(c(n).audits.total)+" entries",1)]),_(z,{links:c(n).audits.links},null,8,["links"])])])])]),s("div",{class:I(["modal fade",{"show d-block":v.value}]),id:"exampleLargeModal",tabindex:"-1","aria-hidden":"true"},[s("div",us,[s("div",ps,[s("div",{class:"modal-header"},[e[4]||(e[4]=s("h5",{class:"modal-title"},"Audit Details",-1)),s("button",{type:"button",class:"btn-close",onClick:N})]),r.value?(a(),o("div",_s,[s("p",null,[e[5]||(e[5]=s("strong",null,"IP Address:",-1)),h(" "+l(((C=r.value)==null?void 0:C.ip_address)||"N/A"),1)]),s("p",null,[e[6]||(e[6]=s("strong",null,"User Agent:",-1)),h(" "+l(((D=r.value)==null?void 0:D.user_agent)||"N/A"),1)]),s("p",null,[e[7]||(e[7]=s("strong",null,"URL:",-1)),h(l((O=r.value)==null?void 0:O.url),1)])])):m("",!0),s("div",{class:"modal-footer"},[s("button",{class:"btn btn-secondary",onClick:N},"Close")])])])],2)]}),_:1})],64))}};export{ks as default};
