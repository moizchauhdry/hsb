import{Q as H,m as c,T as X,C as T,o as a,c as d,u as t,e as q,w as Q,h as _,b as l,g as J,n as N,j as p,s as m,F as b,d as g,a as n,x as y,t as r,f as D,q as f}from"./app-af507bfe.js";import{_ as u}from"./InputError-37dddbdd.js";import{X as I}from"./vue-datepicker-72481e48.js";/* empty css             */import{_ as W}from"./PrimaryButton-9c50d3ed.js";const Y={class:"col"},Z={key:1,class:"modal fade show",id:"exampleLargeModal",tabindex:"-1","aria-hidden":"true",style:{display:"block"}},h={class:"modal-dialog modal-lg"},ee={class:"modal-content"},se={class:"modal-body"},le={id:"stepper1",class:"bs-stepper"},te={class:"card"},oe={class:"card-header"},ne={class:"d-lg-flex flex-lg-row align-items-lg-center justify-content-lg-between",role:"tablist"},re={class:"step"},ie={class:"step-trigger",role:"tab"},ue={class:"step"},ae={class:"step-trigger",role:"tab"},de={class:"step"},pe={class:"step-trigger",role:"tab"},me={class:"card-body"},ce={key:0,class:"row g-2"},_e={class:"col-md-4"},ye=["value"],be={class:"col-md-4"},ge=["value"],ve={class:"col-md-4"},fe={class:"col-md-4"},xe={class:"col-md-4"},ke=["disabled"],Ve={class:"col-md-4"},Ce={class:"col-md-4"},Pe={class:"col-md-4"},Se=["value"],we={class:"col-md-4"},Ue=["value"],Be={class:"col-md-4"},Ne=["value"],De={class:"col-md-4"},Ie={class:"col-md-4"},Ee={class:"col-md-4"},Le={class:"col-md-4"},Ae={class:"col-md-4"},Te={key:1,class:"row g-2"},$e={class:"border mb-4",id:"partner"},Re={class:"table-responsive"},Fe={class:"table",style:{"margin-top":"10px","margin-bottom":"10px"}},Ke={style:{"text-align":"center"}},Me={style:{"text-align":"center"}},Oe={style:{"text-align":"center"}},je={style:{"text-align":"center"}},ze={style:{"text-align":"center"}},Ge={class:"table-responsive"},He={class:"table table-bordered text-capitalize"},Xe={class:"table-responsive"},qe={class:"table table-bordered text-capitalize"},Qe={class:"card-footer"},Je={class:"col-12"},We={class:"d-flex align-items-center gap-3"},Ye={key:2,class:"btn btn-success px-4"},os={__name:"CreateEdit",props:{policy:Object},setup(Ze,{expose:$}){const R=H().props.can,v=c(!1),x=c(!1),E=c([]),k=c([]),V=c([]),C=c([]),P=c([]),S=c([]),s=X({current_step:1,total_step:3,policy_id:"",client_id:"",insurer_id:"",co_insurance:"",insurance_type:"",lead_type:"",department_id:"",policy_no:"",agency_id:"",agency_code:"",cob_id:"",policy_type:"",date_of_issuance:"",policy_period_start:"",policy_period_end:"",sum_insured:"",gross_premium:"",net_premium:"",cover_note_no:"",installment_plan:"",leader:"",leader_policy_no:"",branch:"",brokerage_amount:"",tax:"",percentage:"",brokerage_amount:""}),F=()=>{v.value=!0,x.value=!1,f.get("/policy/create").then(({data:i})=>{E.value=i.users,k.value=i.clients,V.value=i.insurances,C.value=i.agencies,S.value=i.departments})},K=()=>{f.get(`/policy/getDepartmentByBusinessClass/${s.department_id}`).then(({data:i})=>{P.value=i.cobs}).catch(i=>{console.error("Error fetching business classes:",i)})},L=()=>{x.value?s.post(route("policy.update"),{preserveScroll:!0,onSuccess:()=>{s.current_step++,s.current_step>3&&w()},onError:()=>A(),onFinish:()=>{}}):s.post(route("policy.store"),{preserveScroll:!0,onSuccess:()=>{s.current_step++,s.current_step>3&&w()},onError:()=>A(),onFinish:()=>{}})},A=()=>{},M=()=>{s.current_step>1&&s.current_step--},O=()=>{s.current_step<s.total_step&&L()},w=()=>{v.value=!1,s.current_step=1,s.errors={},s.policy_id="",s.client_id="",s.insurer_id="",s.co_insurance="",s.insurance_type="",s.policy_no="",s.agency_id="",s.agency_code="",s.cob_id="",s.policy_type="",s.date_of_issuance="",s.policy_period_start="",s.policy_period_end="",s.sum_insured="",s.gross_premium="",s.net_premium="",s.cover_note_no="",s.installment_plan="",s.leader="",s.leader_policy_no="",s.branch="",s.brokerage_amount="",s.user_id="",s.tax="",s.rate_percentage=""},j=i=>{v.value=!0,x.value=!0,f.get(`/policy/edit/${i}`).then(({data:e})=>{E.value=e.users,k.value=e.clients,V.value=e.insurances,C.value=e.agencies,P.value=e.cobs,S.value=e.departments,s.policy_id=e.policy.id,s.client_id=e.policy.client_id,s.insurer_id=e.policy.insurer_id,s.co_insurance=e.policy.co_insurance,s.insurance_type=e.policy.insurance_type,s.department_id=e.policy.department_id,s.lead_type=e.policy.lead_type,s.policy_no=e.policy.policy_no,s.agency_id=e.policy.agency_id,s.agency_code=e.policy.agency_code,s.cob_id=e.policy.cob_id,s.policy_type=e.policy.policy_type,s.date_of_issuance=e.policy.date_of_issuance,s.policy_period_start=e.policy.policy_period_start,s.policy_period_end=e.policy.policy_period_end,s.sum_insured=e.policy.sum_insured,s.gross_premium=e.policy.gross_premium,s.net_premium=e.policy.net_premium,s.cover_note_no=e.policy.cover_note_no,s.installment_plan=e.policy.installment_plan,s.leader=e.policy.leader,s.leader_policy_no=e.policy.leader_policy_no,s.branch=e.policy.branch,s.brokerage_amount=e.policy.brokerage_amount,s.tax=e.policy.tax,s.rate_percentage=e.policy.percentage,s.brokerage_amount=e.policy.brokerage_amount})};$({edit:i=>j(i)});const z=()=>s.department_id===1?s.net_premium!==0?s.sum_insured/s.net_premium:null:s.department_id!==null&&s.gross_premium!==0?s.sum_insured/s.gross_premium:null;T(()=>z(),i=>{s.rate_percentage=i});let U=null;const G=()=>{f.get(`/policy/getBusinessClassByPercent/${s.cob_id}`).then(({data:i})=>{U=i.cobPercentage,s.gross_premium&&B()}).catch(i=>{console.error("Error fetching percentage:",i)})},B=()=>{U&&s.gross_premium&&(s.brokerage_amount=s.gross_premium*U/100)};return T(()=>s.gross_premium,B),(i,e)=>(a(),d("div",Y,[t(R).policy_create?(a(),q(W,{key:0,onClick:F,class:"mr-1"},{default:Q(()=>e[21]||(e[21]=[l("i",{class:"bx bx-plus text-lg"},null,-1),D(" Add Policy")])),_:1})):_("",!0),v.value?(a(),d("div",Z,[l("div",h,[l("div",ee,[l("form",{onSubmit:e[20]||(e[20]=J(o=>L(),["prevent"]))},[l("div",{class:"modal-header"},[e[22]||(e[22]=l("h5",{class:"modal-title"},"Policies",-1)),l("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:w})]),l("div",se,[l("div",le,[l("div",te,[l("div",oe,[l("div",ne,[l("div",re,[l("div",ie,[l("div",{class:N(["bs-stepper-circle",{"bs-stepper-circle-active":t(s).current_step==1}])}," 1 ",2),e[23]||(e[23]=l("div",{class:""},[l("h5",{class:"mb-0 steper-title"},"Policy Info "),l("p",{class:"mb-0 steper-sub-title"},"Enter Policy Details")],-1))])]),e[26]||(e[26]=l("div",{class:"bs-stepper-line"},null,-1)),l("div",ue,[l("div",ae,[l("div",{class:N(["bs-stepper-circle",{"bs-stepper-circle-active":t(s).current_step==2}])}," 2 ",2),e[24]||(e[24]=l("div",{class:""},[l("h5",{class:"mb-0 steper-title"},"Policy Amount"),l("p",{class:"mb-0 steper-sub-title"},"Setup Policy Amount")],-1))])]),e[27]||(e[27]=l("div",{class:"bs-stepper-line"},null,-1)),l("div",de,[l("div",pe,[l("div",{class:N(["bs-stepper-circle",{"bs-stepper-circle-active":t(s).current_step==3}])}," 3 ",2),e[25]||(e[25]=l("div",{class:""},[l("h5",{class:"mb-0 steper-title"},"Confirmation"),l("p",{class:"mb-0 steper-sub-title"},"Policy Confirmation")],-1))])])])]),l("div",me,[t(s).current_step==1?(a(),d("div",ce,[l("div",_e,[e[28]||(e[28]=l("label",{for:"input13",class:"form-label"},"Client",-1)),p(l("select",{id:"input21",class:"form-select","onUpdate:modelValue":e[0]||(e[0]=o=>t(s).client_id=o)},[(a(!0),d(b,null,g(k.value,o=>(a(),d("option",{key:o.id,value:o.id},r(o.name),9,ye))),128))],512),[[m,t(s).client_id]]),n(u,{message:t(s).errors.client_id},null,8,["message"])]),l("div",be,[e[29]||(e[29]=l("label",{for:"input21",class:"form-label"},"Insurer",-1)),p(l("select",{id:"input21",class:"form-select","onUpdate:modelValue":e[1]||(e[1]=o=>t(s).insurer_id=o)},[(a(!0),d(b,null,g(V.value,o=>(a(),d("option",{key:o.id,value:o.id},r(o.name),9,ge))),128))],512),[[m,t(s).insurer_id]]),n(u,{message:t(s).errors.insurer_id},null,8,["message"])]),l("div",ve,[e[31]||(e[31]=l("label",{for:"input21",class:"form-label"},"Insurance type",-1)),p(l("select",{id:"input21",class:"form-select","onUpdate:modelValue":e[2]||(e[2]=o=>t(s).insurance_type=o)},e[30]||(e[30]=[l("option",{value:"takaful"},"Takaful",-1),l("option",{value:"conventional"},"Conventional",-1)]),512),[[m,t(s).insurance_type]]),n(u,{message:t(s).errors.insurance_type},null,8,["message"])]),l("div",fe,[e[33]||(e[33]=l("label",{for:"input21",class:"form-label"},"Lead type",-1)),p(l("select",{id:"input21",class:"form-select","onUpdate:modelValue":e[3]||(e[3]=o=>t(s).lead_type=o)},e[32]||(e[32]=[l("option",{value:"1"},"Direct 100%",-1),l("option",{value:"2"},"Our lead",-1),l("option",{value:"3"},"Other lead",-1)]),512),[[m,t(s).lead_type]]),n(u,{message:t(s).errors.lead_type},null,8,["message"])]),l("div",xe,[e[34]||(e[34]=l("label",{for:"input13",class:"form-label"},"Co insurance",-1)),p(l("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":e[4]||(e[4]=o=>t(s).co_insurance=o),disabled:t(s).lead_type==="2"},null,8,ke),[[y,t(s).co_insurance]]),n(u,{message:t(s).errors.co_insurance},null,8,["message"])]),l("div",Ve,[e[35]||(e[35]=l("label",{for:"input13",class:"form-label"},"Policy No",-1)),p(l("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":e[5]||(e[5]=o=>t(s).policy_no=o)},null,512),[[y,t(s).policy_no]]),n(u,{message:t(s).errors.policy_no},null,8,["message"])]),l("div",Ce,[e[36]||(e[36]=l("label",{for:"input13",class:"form-label"},"Cover note no",-1)),p(l("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":e[6]||(e[6]=o=>t(s).cover_note_no=o)},null,512),[[y,t(s).cover_note_no]]),n(u,{message:t(s).errors.cover_note_no},null,8,["message"])]),l("div",Pe,[e[37]||(e[37]=l("label",{for:"input21",class:"form-label"},"Agency",-1)),p(l("select",{id:"input21",class:"form-select","onUpdate:modelValue":e[7]||(e[7]=o=>t(s).agency_id=o)},[(a(!0),d(b,null,g(C.value,o=>(a(),d("option",{key:o.id,value:o.id},r(o.name),9,Se))),128))],512),[[m,t(s).agency_id]]),n(u,{message:t(s).errors.agency_id},null,8,["message"])]),l("div",we,[e[38]||(e[38]=l("label",{for:"departmentSelect",class:"form-label"},"Department",-1)),p(l("select",{id:"departmentSelect",class:"form-select","onUpdate:modelValue":e[8]||(e[8]=o=>t(s).department_id=o),onChange:K},[(a(!0),d(b,null,g(S.value,o=>(a(),d("option",{value:o.id},r(o.name),9,Ue))),256))],544),[[m,t(s).department_id]]),n(u,{message:t(s).errors.department_id},null,8,["message"])]),l("div",Be,[e[39]||(e[39]=l("label",{for:"businessClassSelect",class:"form-label"},"Business Class",-1)),p(l("select",{id:"businessClassSelect",class:"form-select","onUpdate:modelValue":e[9]||(e[9]=o=>t(s).cob_id=o),onChange:G},[(a(!0),d(b,null,g(P.value,o=>(a(),d("option",{value:o.id},r(o.class_name),9,Ne))),256))],544),[[m,t(s).cob_id]]),n(u,{message:t(s).errors.cob_id},null,8,["message"])]),l("div",De,[e[41]||(e[41]=l("label",{for:"input21",class:"form-label"},"Policy Type",-1)),p(l("select",{id:"input21",class:"form-select","onUpdate:modelValue":e[10]||(e[10]=o=>t(s).policy_type=o)},e[40]||(e[40]=[l("option",{value:"new"},"New",-1),l("option",{value:"renewal"},"Renewal",-1),l("option",{value:"endorsement"},"Endorsement",-1),l("option",{value:"other"},"Other",-1)]),512),[[m,t(s).policy_type]]),n(u,{message:t(s).errors.policy_type},null,8,["message"])]),l("div",Ie,[e[42]||(e[42]=l("label",{for:"",class:"form-label"},"Date of Issuance",-1)),n(t(I),{modelValue:t(s).date_of_issuance,"onUpdate:modelValue":e[11]||(e[11]=o=>t(s).date_of_issuance=o),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(u,{message:t(s).errors.date_of_issuance},null,8,["message"])]),l("div",Ee,[e[43]||(e[43]=l("label",{for:"input13",class:"form-label"},"Inception Date",-1)),n(t(I),{modelValue:t(s).policy_period_start,"onUpdate:modelValue":e[12]||(e[12]=o=>t(s).policy_period_start=o),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(u,{message:t(s).errors.policy_period_start},null,8,["message"])]),l("div",Le,[e[44]||(e[44]=l("label",{for:"input13",class:"form-label"},"Expiry Date",-1)),n(t(I),{modelValue:t(s).policy_period_end,"onUpdate:modelValue":e[13]||(e[13]=o=>t(s).policy_period_end=o),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(u,{message:t(s).errors.policy_period_end},null,8,["message"])]),l("div",Ae,[e[46]||(e[46]=l("label",{for:"input13",class:"form-label"},"Installment plan",-1)),p(l("select",{id:"input21",class:"form-select","onUpdate:modelValue":e[14]||(e[14]=o=>t(s).installment_plan=o)},e[45]||(e[45]=[l("option",{value:"2"},"2",-1),l("option",{value:"3"},"3",-1),l("option",{value:"4"},"4",-1)]),512),[[m,t(s).installment_plan]]),n(u,{message:t(s).errors.installment_plan},null,8,["message"])])])):_("",!0),t(s).current_step==2?(a(),d("div",Te,[l("div",$e,[l("div",Re,[l("table",Fe,[l("tr",Ke,[e[47]||(e[47]=l("th",null,"Sum insured",-1)),l("td",null,[p(l("input",{type:"number",class:"form-control",id:"sum_insured","onUpdate:modelValue":e[15]||(e[15]=o=>t(s).sum_insured=o)},null,512),[[y,t(s).sum_insured]]),n(u,{message:t(s).errors.sum_insured},null,8,["message"])])]),l("tr",Me,[e[48]||(e[48]=l("th",null,"Gross premium",-1)),l("td",null,[p(l("input",{type:"number",class:"form-control",id:"gross_premium","onUpdate:modelValue":e[16]||(e[16]=o=>t(s).gross_premium=o),onInput:B},null,544),[[y,t(s).gross_premium]]),n(u,{message:t(s).errors.gross_premium},null,8,["message"])])]),l("tr",Oe,[e[49]||(e[49]=l("th",null,"Net premium",-1)),l("td",null,[p(l("input",{type:"number",class:"form-control",id:"net_premium","onUpdate:modelValue":e[17]||(e[17]=o=>t(s).net_premium=o)},null,512),[[y,t(s).net_premium]]),n(u,{message:t(s).errors.net_premium},null,8,["message"])])]),l("tr",je,[e[50]||(e[50]=l("th",null,"Percentage",-1)),l("td",null,[p(l("input",{type:"number",class:"form-control",id:"percentage","onUpdate:modelValue":e[18]||(e[18]=o=>t(s).rate_percentage=o),readonly:""},null,512),[[y,t(s).rate_percentage]]),n(u,{message:t(s).errors.rate_percentage},null,8,["message"])])]),l("tr",ze,[e[51]||(e[51]=l("th",null,"HSB Profit",-1)),l("td",null,[p(l("input",{type:"number",class:"form-control",id:"brokerage_amount","onUpdate:modelValue":e[19]||(e[19]=o=>t(s).brokerage_amount=o)},null,512),[[y,t(s).brokerage_amount]]),n(u,{message:t(s).errors.brokerage_amount},null,8,["message"])])])])])])])):_("",!0),t(s).current_step==3?(a(),d(b,{key:2},[l("div",Ge,[l("table",He,[e[64]||(e[64]=l("tr",null,[l("th",{colspan:"4",class:"bg-primary text-white"}," Policy Detail ")],-1)),l("tr",null,[e[52]||(e[52]=l("th",null,"Client",-1)),l("td",null,r(t(s).client_id),1),e[53]||(e[53]=l("th",null,"Insurance",-1)),l("td",null,r(t(s).insurer_id),1)]),l("tr",null,[e[54]||(e[54]=l("th",null,"Insurance type",-1)),l("td",null,r(t(s).insurance_type),1),e[55]||(e[55]=l("th",null,"Lead type",-1)),l("td",null,r(t(s).lead_type),1)]),l("tr",null,[e[56]||(e[56]=l("th",null,"Co Insurance",-1)),l("td",null,r(t(s).co_insurance),1),e[57]||(e[57]=l("th",null,"Policy No.",-1)),l("td",null,r(t(s).policy_no),1)]),l("tr",null,[e[58]||(e[58]=l("th",null,"Agency",-1)),l("td",null,r(t(s).agency_id),1),e[59]||(e[59]=l("th",null,"Department",-1)),l("td",null,r(t(s).department_id),1)]),l("tr",null,[e[60]||(e[60]=l("th",null,"Class of Business",-1)),l("td",null,r(t(s).cob_id),1),e[61]||(e[61]=l("th",null,"Policy Type",-1)),l("td",null,r(t(s).policy_type),1)]),l("tr",null,[e[62]||(e[62]=l("th",null," Cover Note No ",-1)),l("td",null,r(t(s).cover_note_no),1),e[63]||(e[63]=l("th",null,"Installment Plan ",-1)),l("td",null,r(t(s).installment_plan),1)])])]),l("div",Xe,[l("table",qe,[e[70]||(e[70]=l("tr",null,[l("th",{colspan:"4",class:"bg-primary text-white"}," Policy Amount ")],-1)),l("tr",null,[e[65]||(e[65]=l("th",null,"Sum insured ",-1)),l("td",null," PKR "+r(t(s).sum_insured.toLocaleString()),1),e[66]||(e[66]=l("th",null,"Gross Premium ",-1)),l("td",null," PKR "+r(t(s).gross_premium.toLocaleString()),1)]),l("tr",null,[e[67]||(e[67]=l("th",null,"Net Premium ",-1)),l("td",null," PKR "+r(t(s).net_premium.toLocaleString()),1),e[68]||(e[68]=l("th",null,"Percentage",-1)),l("td",null,r(t(s).rate_percentage)+" % ",1)]),l("tr",null,[e[69]||(e[69]=l("th",null,"HSB profit",-1)),l("td",null," PKR "+r(t(s).brokerage_amount.toLocaleString()),1)])])])],64)):_("",!0)]),l("div",Qe,[l("div",Je,[l("div",We,[[2,3].includes(t(s).current_step)?(a(),d("button",{key:0,class:"btn btn-outline-secondary px-4",type:"button",onClick:M},e[71]||(e[71]=[l("i",{class:"bx bx-left-arrow-alt me-2"},null,-1),D("Previous")]))):_("",!0),[1,2].includes(t(s).current_step)?(a(),d("button",{key:1,class:"btn btn-primary px-4",type:"button",onClick:O},e[72]||(e[72]=[D("Next"),l("i",{class:"bx bx-right-arrow-alt ms-2"},null,-1)]))):_("",!0),t(s).current_step==3?(a(),d("button",Ye,"Save & Submit")):_("",!0)])])])])])])],32)])])])):_("",!0)]))}};export{os as default};
