import{q as p,v as T,E as R,c as a,a as n,w as G,b as e,g as H,n as E,u as t,j as d,y as u,F as y,r as b,s as m,h,t as i,f as N,z as f,o as _}from"./app-cda53c72.js";import{_ as c}from"./InputError-db9df565.js";import{Z as B}from"./vue-datepicker-1563d7a5.js";/* empty css             */import{_ as Z}from"./SuccessButton-bdab0ec1.js";const q={class:"col"},J=e("i",{class:"bx bx-plus text-lg"},null,-1),Q={key:0,class:"modal fade show",id:"exampleLargeModal",tabindex:"-1","aria-hidden":"true",style:{display:"block"}},W={class:"modal-dialog modal-lg"},X={class:"modal-content"},Y=e("h5",{class:"modal-title"},"Policies",-1),ee={class:"modal-body"},se={id:"stepper1",class:"bs-stepper"},te={class:"card"},le={class:"card-header"},oe={class:"d-lg-flex flex-lg-row align-items-lg-center justify-content-lg-between",role:"tablist"},ne={class:"step"},ie={class:"step-trigger",role:"tab"},re=e("div",{class:""},[e("h5",{class:"mb-0 steper-title"},"Policy Info "),e("p",{class:"mb-0 steper-sub-title"},"Enter Policy Details")],-1),ce=e("div",{class:"bs-stepper-line"},null,-1),ae={class:"step"},_e={class:"step-trigger",role:"tab"},de=e("div",{class:""},[e("h5",{class:"mb-0 steper-title"},"Policy Amount"),e("p",{class:"mb-0 steper-sub-title"},"Setup Policy Amount")],-1),ue=e("div",{class:"bs-stepper-line"},null,-1),pe={class:"step"},me={class:"step-trigger",role:"tab"},he=e("div",{class:""},[e("h5",{class:"mb-0 steper-title"},"Confirmation"),e("p",{class:"mb-0 steper-sub-title"},"Policy Confirmation")],-1),ye={class:"card-body"},be={key:0,class:"row g-2"},ge={class:"col-md-4"},fe=e("label",{for:"input13",class:"form-label"},"Client",-1),ve=["value"],xe={class:"col-md-4"},ke=e("label",{for:"input21",class:"form-label"},"Insurer",-1),Ve=["value"],we={class:"col-md-4"},Ce=e("label",{for:"input21",class:"form-label"},"Insurance type",-1),Pe=e("option",{value:"1"},"Takaful",-1),Se=e("option",{value:"2"},"Conventional",-1),Ue=[Pe,Se],Ee={class:"col-md-4"},Ne=e("label",{for:"input21",class:"form-label"},"Lead type",-1),Be=e("option",{value:"1"},"Direct 100%",-1),De=e("option",{value:"2"},"Our lead",-1),Ie=e("option",{value:"3"},"Other lead",-1),Le=[Be,De,Ie],Re={class:"col-md-4"},Ae=e("label",{for:"input13",class:"form-label"},"Co insurance",-1),$e=["disabled"],Fe={class:"col-md-4"},Ke=e("label",{for:"input13",class:"form-label"},"Policy No",-1),Me={class:"col-md-4"},Oe=e("label",{for:"input13",class:"form-label"},"Cover note no",-1),je={class:"col-md-4"},ze=e("label",{for:"input21",class:"form-label"},"Agency",-1),Te=["value"],Ge={class:"col-md-4"},He=e("label",{for:"departmentSelect",class:"form-label"},"Department",-1),Ze=["value"],qe={class:"col-md-4"},Je=e("label",{for:"businessClassSelect",class:"form-label"},"Business Class",-1),Qe=["value"],We={class:"col-md-4"},Xe=e("label",{for:"input21",class:"form-label"},"New/Renewal/Endorsement",-1),Ye=e("option",{value:"new"},"New",-1),es=e("option",{value:"renewal"},"Renewal",-1),ss=e("option",{value:"endorsment"},"Endorsement",-1),ts=e("option",{value:"others"},"Others",-1),ls=[Ye,es,ss,ts],os={class:"col-md-4"},ns=e("label",{for:"",class:"form-label"},"Date of Insurer",-1),is={class:"col-md-4"},rs=e("label",{for:"input13",class:"form-label"},"Inception Date",-1),cs={class:"col-md-4"},as=e("label",{for:"input13",class:"form-label"},"Expiry Date",-1),_s={class:"col-md-4"},ds=e("label",{for:"input13",class:"form-label"},"Installment plan",-1),us=e("option",{value:"2"},"2",-1),ps=e("option",{value:"3"},"3",-1),ms=e("option",{value:"4"},"4",-1),hs=[us,ps,ms],ys={key:1,class:"row g-2"},bs={class:"border mb-4",id:"partner"},gs={class:"table-responsive"},fs={class:"table",style:{"margin-top":"10px","margin-bottom":"10px"}},vs={style:{"text-align":"center"}},xs=e("th",null,"Sum insured",-1),ks={style:{"text-align":"center"}},Vs=e("th",null,"Gross premium",-1),ws={style:{"text-align":"center"}},Cs=e("th",null,"Net premium",-1),Ps={style:{"text-align":"center"}},Ss=e("th",null,"Percentage",-1),Us={style:{"text-align":"center"}},Es=e("th",null,"HSB Profit",-1),Ns=e("h6",null,"Please finalize data.",-1),Bs={class:"table-responsive",style:{"overflow-x":"hidden"}},Ds={class:"container-fluid"},Is={class:"border mb-4",id:"partner"},Ls=e("div",{style:{"background-color":"#037DE2"}},[e("h5",{style:{"text-align":"center"},class:"w-auto title"},"Policy Info")],-1),Rs={class:"row"},As={class:"table table-bordered",style:{"margin-left":"18px"}},$s=e("th",null,"Client",-1),Fs=e("th",null,"Insurance",-1),Ks=e("th",null,"Insurance type",-1),Ms=e("th",null,"Lead type",-1),Os=e("th",null,"Co Insurance",-1),js=e("th",null,"Policy No.",-1),zs=e("th",null,"Agency",-1),Ts=e("th",null,"Department",-1),Gs=e("th",null,"Class business",-1),Hs=e("th",null,"New/Renewal/Endorsment",-1),Zs=e("th",null," Cover Note No ",-1),qs=e("th",null,"Installment Plan ",-1),Js=e("tr",null,null,-1),Qs={class:"border mb-4",id:"partner"},Ws=e("div",{style:{"background-color":"#037DE2"}},[e("h5",{style:{"text-align":"center"},class:"w-auto title"},"Policy Amount")],-1),Xs={class:"row"},Ys={class:"table table-bordered",style:{"margin-left":"18px"}},et=e("th",null,"Sum insured ",-1),st=e("th",null,"Gross Premium ",-1),tt=e("th",null,"Net Premium ",-1),lt=e("th",null,"Percentage",-1),ot=e("th",null,"HSB profit",-1),nt={class:"card-footer"},it={class:"col-12"},rt={class:"d-flex align-items-center gap-3"},ct=e("i",{class:"bx bx-left-arrow-alt me-2"},null,-1),at=e("i",{class:"bx bx-right-arrow-alt ms-2"},null,-1),_t={key:2,class:"btn btn-success px-4"},bt={__name:"CreateEdit",props:{policy:Object},setup(dt,{expose:A}){const g=p(!1),v=p(!1),D=p([]),x=p([]),k=p([]),V=p([]),w=p([]),C=p([]),s=T({current_step:1,total_step:3,policy_id:"",client_id:"",insurance_id:"",co_insurance:"",takeful_type:"",lead_type:"",department_id:"",policy_no:"",agency_id:"",agency_code:"",class_of_business_id:"",orignal_endorsment:"",date_of_insurance:"",policy_period_start:"",policy_period_end:"",sum_insured:"",gross_premium:"",net_premium:"",cover_note_no:"",installment_plan:"",leader:"",leader_policy_no:"",branch:"",brokerage_amount:"",tax:"",percentage:"",hsb_profit:""}),$=()=>{g.value=!0,v.value=!1,f.get("/policy/create").then(({data:r})=>{D.value=r.users,x.value=r.clients,k.value=r.insurances,V.value=r.agencies,C.value=r.departments})},F=()=>{f.get(`/policy/getDepartmentByBusinessClass/${s.department_id}`).then(({data:r})=>{w.value=r.cobs}).catch(r=>{console.error("Error fetching business classes:",r)})},I=()=>{v.value?s.post(route("policy.update"),{preserveScroll:!0,onSuccess:()=>{s.current_step++,s.current_step>3&&P()},onError:()=>L(),onFinish:()=>{}}):s.post(route("policy.store"),{preserveScroll:!0,onSuccess:()=>{s.current_step++,s.current_step>3&&P()},onError:()=>L(),onFinish:()=>{}})},L=()=>{},K=()=>{s.current_step>1&&s.current_step--},M=()=>{s.current_step<s.total_step&&I()},P=()=>{g.value=!1,s.current_step=1,s.errors={},s.policy_id="",s.client_id="",s.insurance_id="",s.co_insurance="",s.takeful_type="",s.policy_no="",s.agency_id="",s.agency_code="",s.class_of_business_id="",s.orignal_endorsment="",s.date_of_insurance="",s.policy_period_start="",s.policy_period_end="",s.sum_insured="",s.gross_premium="",s.net_premium="",s.cover_note_no="",s.installment_plan="",s.leader="",s.leader_policy_no="",s.branch="",s.brokerage_amount="",s.user_id="",s.tax="",s.percentage=""},O=r=>{g.value=!0,v.value=!0,f.get(`/policy/edit/${r}`).then(({data:l})=>{D.value=l.users,x.value=l.clients,k.value=l.insurances,V.value=l.agencies,w.value=l.cobs,C.value=l.departments,s.policy_id=l.policy.id,s.client_id=l.policy.client_id,s.insurance_id=l.policy.insurance_id,s.co_insurance=l.policy.co_insurance,s.takeful_type=l.policy.takeful_type,s.department_id=l.policy.department_id,s.lead_type=l.policy.lead_type,s.policy_no=l.policy.policy_no,s.agency_id=l.policy.agency_id,s.agency_code=l.policy.agency_code,s.class_of_business_id=l.policy.class_of_business_id,s.orignal_endorsment=l.policy.orignal_endorsment,s.date_of_insurance=l.policy.date_of_insurance,s.policy_period_start=l.policy.policy_period_start,s.policy_period_end=l.policy.policy_period_end,s.sum_insured=l.policy.sum_insured,s.gross_premium=l.policy.gross_premium,s.net_premium=l.policy.net_premium,s.cover_note_no=l.policy.cover_note_no,s.installment_plan=l.policy.installment_plan,s.leader=l.policy.leader,s.leader_policy_no=l.policy.leader_policy_no,s.branch=l.policy.branch,s.brokerage_amount=l.policy.brokerage_amount,s.tax=l.policy.tax,s.percentage=l.policy.percentage,s.hsb_profit=l.policy.hsb_profit})};A({edit:r=>O(r)});const j=()=>s.department_id===1?s.net_premium!==0?s.sum_insured/s.net_premium:null:s.department_id!==null&&s.gross_premium!==0?s.sum_insured/s.gross_premium:null;R(()=>j(),r=>{s.percentage=r});let S=null;const z=()=>{f.get(`/policy/getBusinessClassByPercent/${s.class_of_business_id}`).then(({data:r})=>{S=r.cobPercentage,s.gross_premium&&U()}).catch(r=>{console.error("Error fetching percentage:",r)})},U=()=>{S&&s.gross_premium&&(s.hsb_profit=s.gross_premium*S/100)};return R(()=>s.gross_premium,U),(r,l)=>(_(),a("div",q,[n(Z,{onClick:$,class:"mr-1"},{default:G(()=>[J,N(" Add Policy")]),_:1}),g.value?(_(),a("div",Q,[e("div",W,[e("div",X,[e("form",{onSubmit:l[20]||(l[20]=H(o=>I(),["prevent"]))},[e("div",{class:"modal-header"},[Y,e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:P})]),e("div",ee,[e("div",se,[e("div",te,[e("div",le,[e("div",oe,[e("div",ne,[e("div",ie,[e("div",{class:E(["bs-stepper-circle",{"bs-stepper-circle-active":t(s).current_step==1}])}," 1 ",2),re])]),ce,e("div",ae,[e("div",_e,[e("div",{class:E(["bs-stepper-circle",{"bs-stepper-circle-active":t(s).current_step==2}])}," 2 ",2),de])]),ue,e("div",pe,[e("div",me,[e("div",{class:E(["bs-stepper-circle",{"bs-stepper-circle-active":t(s).current_step==3}])}," 3 ",2),he])])])]),e("div",ye,[t(s).current_step==1?(_(),a("div",be,[e("div",ge,[fe,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[0]||(l[0]=o=>t(s).client_id=o)},[(_(!0),a(y,null,b(x.value,o=>(_(),a("option",{key:o.id,value:o.id},i(o.name),9,ve))),128))],512),[[u,t(s).client_id]]),n(c,{message:t(s).errors.client_id},null,8,["message"])]),e("div",xe,[ke,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[1]||(l[1]=o=>t(s).insurance_id=o)},[(_(!0),a(y,null,b(k.value,o=>(_(),a("option",{key:o.id,value:o.id},i(o.name),9,Ve))),128))],512),[[u,t(s).insurance_id]]),n(c,{message:t(s).errors.insurance_id},null,8,["message"])]),e("div",we,[Ce,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[2]||(l[2]=o=>t(s).takeful_type=o)},Ue,512),[[u,t(s).takeful_type]]),n(c,{message:t(s).errors.takeful_type},null,8,["message"])]),e("div",Ee,[Ne,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[3]||(l[3]=o=>t(s).lead_type=o)},Le,512),[[u,t(s).lead_type]]),n(c,{message:t(s).errors.lead_type},null,8,["message"])]),e("div",Re,[Ae,d(e("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":l[4]||(l[4]=o=>t(s).co_insurance=o),disabled:t(s).lead_type==="2"},null,8,$e),[[m,t(s).co_insurance]]),n(c,{message:t(s).errors.co_insurance},null,8,["message"])]),e("div",Fe,[Ke,d(e("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":l[5]||(l[5]=o=>t(s).policy_no=o)},null,512),[[m,t(s).policy_no]]),n(c,{message:t(s).errors.policy_no},null,8,["message"])]),e("div",Me,[Oe,d(e("input",{type:"text",class:"form-control",id:"input13",placeholder:"","onUpdate:modelValue":l[6]||(l[6]=o=>t(s).cover_note_no=o)},null,512),[[m,t(s).cover_note_no]]),n(c,{message:t(s).errors.cover_note_no},null,8,["message"])]),e("div",je,[ze,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[7]||(l[7]=o=>t(s).agency_id=o)},[(_(!0),a(y,null,b(V.value,o=>(_(),a("option",{key:o.id,value:o.id},i(o.name),9,Te))),128))],512),[[u,t(s).agency_id]]),n(c,{message:t(s).errors.agency_id},null,8,["message"])]),e("div",Ge,[He,d(e("select",{id:"departmentSelect",class:"form-select","onUpdate:modelValue":l[8]||(l[8]=o=>t(s).department_id=o),onChange:F},[(_(!0),a(y,null,b(C.value,o=>(_(),a("option",{value:o.id},i(o.name),9,Ze))),256))],544),[[u,t(s).department_id]]),n(c,{message:t(s).errors.department_id},null,8,["message"])]),e("div",qe,[Je,d(e("select",{id:"businessClassSelect",class:"form-select","onUpdate:modelValue":l[9]||(l[9]=o=>t(s).class_of_business_id=o),onChange:z},[(_(!0),a(y,null,b(w.value,o=>(_(),a("option",{value:o.id},i(o.class_name),9,Qe))),256))],544),[[u,t(s).class_of_business_id]]),n(c,{message:t(s).errors.class_of_business_id},null,8,["message"])]),e("div",We,[Xe,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[10]||(l[10]=o=>t(s).orignal_endorsment=o)},ls,512),[[u,t(s).orignal_endorsment]]),n(c,{message:t(s).errors.orignal_endorsment},null,8,["message"])]),e("div",os,[ns,n(t(B),{modelValue:t(s).date_of_insurance,"onUpdate:modelValue":l[11]||(l[11]=o=>t(s).date_of_insurance=o),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(s).errors.date_of_insurance},null,8,["message"])]),e("div",is,[rs,n(t(B),{modelValue:t(s).policy_period_start,"onUpdate:modelValue":l[12]||(l[12]=o=>t(s).policy_period_start=o),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(s).errors.policy_period_start},null,8,["message"])]),e("div",cs,[as,n(t(B),{modelValue:t(s).policy_period_end,"onUpdate:modelValue":l[13]||(l[13]=o=>t(s).policy_period_end=o),"enable-time-picker":!1,"show-time":!1},null,8,["modelValue"]),n(c,{message:t(s).errors.policy_period_end},null,8,["message"])]),e("div",_s,[ds,d(e("select",{id:"input21",class:"form-select","onUpdate:modelValue":l[14]||(l[14]=o=>t(s).installment_plan=o)},hs,512),[[u,t(s).installment_plan]]),n(c,{message:t(s).errors.installment_plan},null,8,["message"])])])):h("",!0),t(s).current_step==2?(_(),a("div",ys,[e("div",bs,[e("div",gs,[e("table",fs,[e("tr",vs,[xs,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"sum_insured","onUpdate:modelValue":l[15]||(l[15]=o=>t(s).sum_insured=o)},null,512),[[m,t(s).sum_insured]]),n(c,{message:t(s).errors.sum_insured},null,8,["message"])])]),e("tr",ks,[Vs,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"gross_premium","onUpdate:modelValue":l[16]||(l[16]=o=>t(s).gross_premium=o),onInput:U},null,544),[[m,t(s).gross_premium]]),n(c,{message:t(s).errors.gross_premium},null,8,["message"])])]),e("tr",ws,[Cs,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"net_premium","onUpdate:modelValue":l[17]||(l[17]=o=>t(s).net_premium=o)},null,512),[[m,t(s).net_premium]]),n(c,{message:t(s).errors.net_premium},null,8,["message"])])]),e("tr",Ps,[Ss,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"percentage","onUpdate:modelValue":l[18]||(l[18]=o=>t(s).percentage=o),readonly:""},null,512),[[m,t(s).percentage]]),n(c,{message:t(s).errors.percentage},null,8,["message"])])]),e("tr",Us,[Es,e("td",null,[d(e("input",{type:"number",class:"form-control",id:"hsb_profit","onUpdate:modelValue":l[19]||(l[19]=o=>t(s).hsb_profit=o)},null,512),[[m,t(s).hsb_profit]]),n(c,{message:t(s).errors.hsb_profit},null,8,["message"])])])])])])])):h("",!0),t(s).current_step==3?(_(),a(y,{key:2},[Ns,e("div",Bs,[e("div",Ds,[e("div",Is,[Ls,e("div",Rs,[e("table",As,[e("tr",null,[$s,e("td",null,i(t(s).client_id),1),Fs,e("td",null,i(t(s).insurance_id),1)]),e("tr",null,[Ks,e("td",null,i(t(s).takeful_type),1),Ms,e("td",null,i(t(s).lead_type),1)]),e("tr",null,[Os,e("td",null,i(t(s).co_insurance),1),js,e("td",null,i(t(s).policy_no),1)]),e("tr",null,[zs,e("td",null,i(t(s).agency_id),1),Ts,e("td",null,i(t(s).department_id),1)]),e("tr",null,[Gs,e("td",null,i(t(s).class_of_business_id),1),Hs,e("td",null,i(t(s).orignal_endorsment),1)]),e("tr",null,[Zs,e("td",null,i(t(s).cover_note_no),1),qs,e("td",null,i(t(s).installment_plan),1)]),Js])])]),e("div",Qs,[Ws,e("div",Xs,[e("table",Ys,[e("tr",null,[et,e("td",null," PKR "+i(t(s).sum_insured.toLocaleString()),1),st,e("td",null," PKR "+i(t(s).gross_premium.toLocaleString()),1)]),e("tr",null,[tt,e("td",null," PKR "+i(t(s).net_premium.toLocaleString()),1),lt,e("td",null,i(t(s).percentage)+" % ",1)]),e("tr",null,[ot,e("td",null," PKR "+i(t(s).hsb_profit.toLocaleString()),1)])])])])])])],64)):h("",!0)]),e("div",nt,[e("div",it,[e("div",rt,[[2,3].includes(t(s).current_step)?(_(),a("button",{key:0,class:"btn btn-outline-secondary px-4",type:"button",onClick:K},[ct,N("Previous")])):h("",!0),[1,2].includes(t(s).current_step)?(_(),a("button",{key:1,class:"btn btn-primary px-4",type:"button",onClick:M},[N("Next"),at])):h("",!0),t(s).current_step==3?(_(),a("button",_t,"Submit")):h("",!0)])])])])])])],32)])])])):h("",!0)]))}};export{bt as default};
